<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-references/framework/sui_system/validator_set" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Module sui_system::validator_set | Sui Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.sui.io/img/sui-doc-og.png"><meta data-rh="true" name="twitter:image" content="https://docs.sui.io/img/sui-doc-og.png"><meta data-rh="true" property="og:url" content="https://docs.sui.io/references/framework/sui_system/validator_set"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Module sui_system::validator_set | Sui Documentation"><meta data-rh="true" name="description" content="-  Struct ValidatorSet"><meta data-rh="true" property="og:description" content="-  Struct ValidatorSet"><link data-rh="true" rel="icon" href="../../../img/favicon.ico"><link data-rh="true" rel="canonical" href="validator_set.html"><link data-rh="true" rel="alternate" href="validator_set.html" hreflang="en"><link data-rh="true" rel="alternate" href="validator_set.html" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ZF283DJAYX-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Sui Documentation" href="../../../opensearch.xml">
<link rel="preconnect" href="https://us.i.posthog.com">
<script>!function(t,e){var o,s,r,a;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,n,p){function c(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(r=t.createElement("script")).type="text/javascript",r.async=!0,r.src=n.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(a=t.getElementsByTagName("script")[0]).parentNode.insertBefore(r,a);var g=e;for(void 0!==p?g=e[p]=[]:p="posthog",g.people=g.people||[],g.toString=function(t){var e="posthog";return"posthog"!==p&&(e+="."+p),t||(e+=" (stub)"),e},g.people.toString=function(){return g.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys onSessionId".split(" "),s=0;s<o.length;s++)c(g,o[s]);e._i.push([i,n,p])},e.__SV=1)}(document,window.posthog||[]),posthog.init("phc_9Ny8QzZBTmsZh0ucEhdknMivaJhATZjbplVVaiirA9T",{api_host:"https://us.i.posthog.com",id:"default"})</script>










<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&amp;display=swap">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"><link rel="stylesheet" href="../../../assets/css/styles.e5383d0f.css">
<script src="../../../assets/js/runtime~main.c6758a96.js" defer="defer"></script>
<script src="../../../assets/js/main.5a96279b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_y7Zq" href="validator_set.html#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="../../../index.html"><div class="navbar__logo"><img src="../../../img/sui-logo.svg" alt="Sui Docs Logo" class="themedComponent_fc7v themedComponent--light_SFoa"><img src="../../../img/sui-logo.svg" alt="Sui Docs Logo" class="themedComponent_fc7v themedComponent--dark_o7dU"></div><b class="navbar__title text--truncate">Sui Documentation</b></a><div class="flex flex-[8_1_0%] items-center justify-start gap-8 min-[1100px]:gap-16"><a class="navbar__item navbar__link" href="../../../guides.html">Guides</a><a class="navbar__item navbar__link" href="../../../concepts.html">Concepts</a><a class="navbar__item navbar__link" href="../../../standards.html">Standards</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="../../../references.html">References</a></div></div><div class="navbar__items navbar__items--right"><div class="flex flex-[8_1_0%] items-center justify-start gap-8 min-[1100px]:gap-16"></div><div class="theme-toggle-wrapper text-white max-[996px]:hidden"><div class="toggle_sgcG"><button class="clean-btn toggleButton_PfWu toggleButtonDisabled_keYU" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pMyg"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_k_Wp"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div><div class="navbarSearchContainer_hdzx"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_obr0"><div class="docsWrapper_cx5y"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_ixAB" type="button"></button><div class="docRoot_o73X"><aside class="theme-doc-sidebar-container docSidebarContainer_sVsO"><div class="sidebarViewport_A_mM"><div class="sidebar_dLPM"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_CWUi"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="../../../references.html">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="../../../build/sui-json.html">Sui RPC</a><button aria-label="Collapse sidebar category &#x27;Sui RPC&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="../../sui-graphql.html">GraphQL (Alpha)</a><button aria-label="Expand sidebar category &#x27;GraphQL (Alpha)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../../sui-api-ref.html">JSON-RPC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../fullnode-protocol.html">Sui Full Node gRPC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../sui-api/rpc-best-practices.html">RPC Best Practices</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="../../cli.html">Sui CLI</a><button aria-label="Collapse sidebar category &#x27;Sui CLI&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../cli/cheatsheet.html">Sui CLI Cheat Sheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../cli/client.html">Sui Client CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../cli/ptb.html">Sui Client PTB CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../cli/console.html">Sui Console CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../cli/keytool.html">Sui Keytool CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../cli/move.html">Sui Move CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../cli/validator.html">Sui Validator CLI</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="../../ide/move.html">Sui IDE Support</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../ide/move.html">Move Analyzer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../ide/debugger.html">Move Trace Debugger</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="../../sui-sdks.html">Sui SDKs</a><button aria-label="Collapse sidebar category &#x27;Sui SDKs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://sdk.mystenlabs.com/dapp-kit" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_ar9B" tabindex="0">dApp Kit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_jSXz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../../rust-sdk.html">Rust SDK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://sdk.mystenlabs.com/typescript" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_ar9B" tabindex="0">TypeScript SDK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_jSXz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://sdk.mystenlabs.com/zksend" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_ar9B" tabindex="0">zkSend SDK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_jSXz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="../../sui-move.html">Move</a><button aria-label="Collapse sidebar category &#x27;Move&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="../../framework.html">Framework</a><button aria-label="Collapse sidebar category &#x27;Framework&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="../bridge.html">Bridge</a><button aria-label="Expand sidebar category &#x27;Bridge&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="../std.html">Std</a><button aria-label="Expand sidebar category &#x27;Std&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="../sui.html">Sui</a><button aria-label="Expand sidebar category &#x27;Sui&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="../sui_system.html">Sui_system</a><button aria-label="Collapse sidebar category &#x27;Sui_system&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="genesis.html">genesis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="stake_subsidy.html">stake_subsidy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="staking_pool.html">staking_pool</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="storage_fund.html">storage_fund</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="sui_system.html">sui_system</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="sui_system_state_inner.html">sui_system_state_inner</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="validator.html">validator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="validator_cap.html">validator_cap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="validator_set.html">validator_set</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="validator_wrapper.html">validator_wrapper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="voting_power.html">voting_power</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://move-book.com/" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_ar9B" tabindex="0">The Move Book<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_jSXz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://move-book.com/reference/" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_ar9B" tabindex="0">The Move Reference<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_jSXz"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="../../../sui-glossary.html">Glossary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="../../contribute/contribution-process.html">Contribute</a><button aria-label="Expand sidebar category &#x27;Contribute&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_DePh"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Iw6L"><div class="docItemContainer_ausd"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_yIz6" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="../../../index.html"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_prGD"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="../../sui-move.html"><span itemprop="name">Move</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="../../framework.html"><span itemprop="name">Framework</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="../sui_system.html"><span itemprop="name">Sui_system</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">validator_set</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_Eyz5 theme-doc-toc-mobile tocMobile_BcqM"><button type="button" class="clean-btn tocCollapsibleButton_PRt6">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Module sui_system::validator_set</h1></header><ul>
<li><a href="validator_set.html#sui_system_validator_set_ValidatorSet">Struct <code>ValidatorSet</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_ValidatorEpochInfoEvent">Struct <code>ValidatorEpochInfoEvent</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_ValidatorEpochInfoEventV2">Struct <code>ValidatorEpochInfoEventV2</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_ValidatorJoinEvent">Struct <code>ValidatorJoinEvent</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_ValidatorLeaveEvent">Struct <code>ValidatorLeaveEvent</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_VotingPowerAdmissionStartEpochKey">Struct <code>VotingPowerAdmissionStartEpochKey</code></a></li>
<li><a href="validator_set.html#@Constants_0">Constants</a></li>
<li><a href="validator_set.html#sui_system_validator_set_new">Function <code>new</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_request_add_validator_candidate">Function <code>request_add_validator_candidate</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_request_remove_validator_candidate">Function <code>request_remove_validator_candidate</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_request_add_validator">Function <code>request_add_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_can_join">Function <code>can_join</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_voting_power_thresholds">Function <code>get_voting_power_thresholds</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_assert_no_pending_or_active_duplicates">Function <code>assert_no_pending_or_active_duplicates</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_request_remove_validator">Function <code>request_remove_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_request_add_stake">Function <code>request_add_stake</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_request_withdraw_stake">Function <code>request_withdraw_stake</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_convert_to_fungible_staked_sui">Function <code>convert_to_fungible_staked_sui</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_redeem_fungible_staked_sui">Function <code>redeem_fungible_staked_sui</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_request_set_commission_rate">Function <code>request_set_commission_rate</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_advance_epoch">Function <code>advance_epoch</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_update_validator_positions_and_calculate_total_stake">Function <code>update_validator_positions_and_calculate_total_stake</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_effectuate_staged_metadata">Function <code>effectuate_staged_metadata</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_derive_reference_gas_price">Function <code>derive_reference_gas_price</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_total_stake">Function <code>total_stake</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_validator_total_stake_amount">Function <code>validator_total_stake_amount</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_validator_stake_amount">Function <code>validator_stake_amount</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_validator_voting_power">Function <code>validator_voting_power</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_validator_staking_pool_id">Function <code>validator_staking_pool_id</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">Function <code>staking_pool_mappings</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_validator_address_by_pool_id">Function <code>validator_address_by_pool_id</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_pool_exchange_rates">Function <code>pool_exchange_rates</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_next_epoch_validator_count">Function <code>next_epoch_validator_count</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_is_active_validator_by_sui_address">Function <code>is_active_validator_by_sui_address</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_is_duplicate_with_active_validator">Function <code>is_duplicate_with_active_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_is_duplicate_validator">Function <code>is_duplicate_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_count_duplicates_vec">Function <code>count_duplicates_vec</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_is_duplicate_with_pending_validator">Function <code>is_duplicate_with_pending_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_count_duplicates_tablevec">Function <code>count_duplicates_tablevec</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_candidate_or_active_validator_mut">Function <code>get_candidate_or_active_validator_mut</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_find_validator">Function <code>find_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_find_validator_from_table_vec">Function <code>find_validator_from_table_vec</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_validator_indices">Function <code>get_validator_indices</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_validator_mut">Function <code>get_validator_mut</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut">Function <code>get_active_or_pending_or_candidate_validator_mut</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_verified_cap">Function <code>get_validator_mut_with_verified_cap</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx">Function <code>get_validator_mut_with_ctx</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx_including_candidates">Function <code>get_validator_mut_with_ctx_including_candidates</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_validator_ref">Function <code>get_validator_ref</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref">Function <code>get_active_or_pending_or_candidate_validator_ref</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_active_validator_ref">Function <code>get_active_validator_ref</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_get_pending_validator_ref">Function <code>get_pending_validator_ref</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_verify_cap">Function <code>verify_cap</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_process_pending_removals">Function <code>process_pending_removals</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_process_validator_departure">Function <code>process_validator_departure</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_clean_report_records_leaving_validator">Function <code>clean_report_records_leaving_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_sort_removal_list">Function <code>sort_removal_list</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_process_pending_stakes_and_withdraws">Function <code>process_pending_stakes_and_withdraws</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_calculate_total_stakes">Function <code>calculate_total_stakes</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_adjust_stake_and_gas_price">Function <code>adjust_stake_and_gas_price</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_compute_reward_adjustments">Function <code>compute_reward_adjustments</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_compute_slashed_validators">Function <code>compute_slashed_validators</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_compute_unadjusted_reward_distribution">Function <code>compute_unadjusted_reward_distribution</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_compute_adjusted_reward_distribution">Function <code>compute_adjusted_reward_distribution</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_distribute_reward">Function <code>distribute_reward</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_emit_validator_epoch_events">Function <code>emit_validator_epoch_events</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_sum_voting_power_by_addresses">Function <code>sum_voting_power_by_addresses</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_active_validators">Function <code>active_validators</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_is_validator_candidate">Function <code>is_validator_candidate</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_is_active_validator">Function <code>is_active_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_is_inactive_validator">Function <code>is_inactive_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_is_at_risk_validator">Function <code>is_at_risk_validator</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_active_validator_addresses">Function <code>active_validator_addresses</code></a></li>
<li><a href="validator_set.html#sui_system_validator_set_mul_div">Macro function <code>mul_div</code></a></li>
</ul>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>use</b> <a href="../std/address.html#std_address">std::address</a>;
<b>use</b> <a href="../std/ascii.html#std_ascii">std::ascii</a>;
<b>use</b> <a href="../std/bcs.html#std_bcs">std::bcs</a>;
<b>use</b> <a href="../std/option.html#std_option">std::option</a>;
<b>use</b> <a href="../std/string.html#std_string">std::string</a>;
<b>use</b> <a href="../std/type_name.html#std_type_name">std::type_name</a>;
<b>use</b> <a href="../std/u64.html#std_u64">std::u64</a>;
<b>use</b> <a href="../std/vector.html#std_vector">std::vector</a>;
<b>use</b> <a href="../sui/address.html#sui_address">sui::address</a>;
<b>use</b> <a href="../sui/bag.html#sui_bag">sui::bag</a>;
<b>use</b> <a href="../sui/balance.html#sui_balance">sui::balance</a>;
<b>use</b> <a href="../sui/coin.html#sui_coin">sui::coin</a>;
<b>use</b> <a href="../sui/config.html#sui_config">sui::config</a>;
<b>use</b> <a href="../sui/deny_list.html#sui_deny_list">sui::deny_list</a>;
<b>use</b> <a href="../sui/dynamic_field.html#sui_dynamic_field">sui::dynamic_field</a>;
<b>use</b> <a href="../sui/dynamic_object_field.html#sui_dynamic_object_field">sui::dynamic_object_field</a>;
<b>use</b> <a href="../sui/event.html#sui_event">sui::event</a>;
<b>use</b> <a href="../sui/hex.html#sui_hex">sui::hex</a>;
<b>use</b> <a href="../sui-framework/object.html#sui_object">sui::object</a>;
<b>use</b> <a href="../sui/party.html#sui_party">sui::party</a>;
<b>use</b> <a href="../sui/priority_queue.html#sui_priority_queue">sui::priority_queue</a>;
<b>use</b> <a href="../sui/sui.html#sui_sui">sui::sui</a>;
<b>use</b> <a href="../sui/table.html#sui_table">sui::table</a>;
<b>use</b> <a href="../sui/table_vec.html#sui_table_vec">sui::table_vec</a>;
<b>use</b> <a href="../sui/transfer.html#sui_transfer">sui::transfer</a>;
<b>use</b> <a href="../sui/tx_context.html#sui_tx_context">sui::tx_context</a>;
<b>use</b> <a href="../sui/types.html#sui_types">sui::types</a>;
<b>use</b> <a href="../sui/url.html#sui_url">sui::url</a>;
<b>use</b> <a href="../sui/vec_map.html#sui_vec_map">sui::vec_map</a>;
<b>use</b> <a href="../sui/vec_set.html#sui_vec_set">sui::vec_set</a>;
<b>use</b> <a href="../sui/versioned.html#sui_versioned">sui::versioned</a>;
<b>use</b> <a href="staking_pool.html#sui_system_staking_pool">sui_system::staking_pool</a>;
<b>use</b> <a href="validator.html#sui_system_validator">sui_system::validator</a>;
<b>use</b> <a href="validator_cap.html#sui_system_validator_cap">sui_system::validator_cap</a>;
<b>use</b> <a href="validator_wrapper.html#sui_system_validator_wrapper">sui_system::validator_wrapper</a>;
<b>use</b> <a href="voting_power.html#sui_system_voting_power">sui_system::voting_power</a>;
</code></pre>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_ValidatorSet">Struct <code>ValidatorSet</code><a href="validator_set.html#sui_system_validator_set_ValidatorSet" class="hash-link" aria-label="Direct link to sui_system_validator_set_ValidatorSet" title="Direct link to sui_system_validator_set_ValidatorSet">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>struct</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a> <b>has</b> store
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Fields</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<dl>
<dt>
<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>: u64
</dt>
<dd>
 Total amount of stake from all active validators at the beginning of the epoch.
 Written only once per epoch, in <a href="validator_set.html#sui_system_validator_set_advance_epoch">advance_epoch</a> function.
</dd>
<dt>
<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>: vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;
</dt>
<dd>
 The current list of active validators.
</dd>
<dt>
pending_active_validators: <a href="../sui/table_vec.html#sui_table_vec_TableVec">sui::table_vec::TableVec</a>&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;
</dt>
<dd>
 List of new validator candidates added during the current epoch.
 They will be processed at the end of the epoch.
</dd>
<dt>
pending_removals: vector&lt;u64&gt;
</dt>
<dd>
 Removal requests from the validators. Each element is an index
 pointing to <a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>.
</dd>
<dt>
<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>: <a href="../sui/table.html#sui_table_Table">sui::table::Table</a>&lt;<a href="../sui-framework/object.html#sui_object_ID">sui::object::ID</a>, <b>address</b>&gt;
</dt>
<dd>
 Mappings from staking pool&#x27;s ID to the sui address of a validator.
</dd>
<dt>
inactive_validators: <a href="../sui/table.html#sui_table_Table">sui::table::Table</a>&lt;<a href="../sui-framework/object.html#sui_object_ID">sui::object::ID</a>, <a href="validator_wrapper.html#sui_system_validator_wrapper_ValidatorWrapper">sui_system::validator_wrapper::ValidatorWrapper</a>&gt;
</dt>
<dd>
 Mapping from a staking pool ID to the inactive validator that has that pool as its staking pool.
 When a validator is deactivated the validator is removed from <a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a> it
 is added to this table so that stakers can continue to withdraw their stake from it.
</dd>
<dt>
validator_candidates: <a href="../sui/table.html#sui_table_Table">sui::table::Table</a>&lt;<b>address</b>, <a href="validator_wrapper.html#sui_system_validator_wrapper_ValidatorWrapper">sui_system::validator_wrapper::ValidatorWrapper</a>&gt;
</dt>
<dd>
 Table storing preactive/candidate validators, mapping their addresses to their Validator  structs.
 When an address calls <a href="validator_set.html#sui_system_validator_set_request_add_validator_candidate">request_add_validator_candidate</a>, they get added to this table and become a preactive
 validator.
 When the candidate has met the min stake requirement, they can call <a href="validator_set.html#sui_system_validator_set_request_add_validator">request_add_validator</a> to
 officially add them to the active validator set <a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a> next epoch.
</dd>
<dt>
at_risk_validators: <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;<b>address</b>, u64&gt;
</dt>
<dd>
 Table storing the number of epochs during which a validator&#x27;s stake has been below the low stake threshold.
</dd>
<dt>
extra_fields: <a href="../sui/bag.html#sui_bag_Bag">sui::bag::Bag</a>
</dt>
<dd>
 Any extra fields that&#x27;s not defined statically.
</dd>
</dl>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_ValidatorEpochInfoEvent">Struct <code>ValidatorEpochInfoEvent</code><a href="validator_set.html#sui_system_validator_set_ValidatorEpochInfoEvent" class="hash-link" aria-label="Direct link to sui_system_validator_set_ValidatorEpochInfoEvent" title="Direct link to sui_system_validator_set_ValidatorEpochInfoEvent">​</a></h2>
<p>Event containing staking and rewards related information of
each validator, emitted during epoch advancement.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>struct</b> <a href="validator_set.html#sui_system_validator_set_ValidatorEpochInfoEvent">ValidatorEpochInfoEvent</a> <b>has</b> <b>copy</b>, drop
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Fields</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<dl>
<dt>
epoch: u64
</dt>
<dd>
</dd>
<dt>
validator_address: <b>address</b>
</dt>
<dd>
</dd>
<dt>
reference_gas_survey_quote: u64
</dt>
<dd>
</dd>
<dt>
stake: u64
</dt>
<dd>
</dd>
<dt>
commission_rate: u64
</dt>
<dd>
</dd>
<dt>
pool_staking_reward: u64
</dt>
<dd>
</dd>
<dt>
storage_fund_staking_reward: u64
</dt>
<dd>
</dd>
<dt>
pool_token_exchange_rate: <a href="staking_pool.html#sui_system_staking_pool_PoolTokenExchangeRate">sui_system::staking_pool::PoolTokenExchangeRate</a>
</dt>
<dd>
</dd>
<dt>
tallying_rule_reporters: vector&lt;<b>address</b>&gt;
</dt>
<dd>
</dd>
<dt>
tallying_rule_global_score: u64
</dt>
<dd>
</dd>
</dl>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_ValidatorEpochInfoEventV2">Struct <code>ValidatorEpochInfoEventV2</code><a href="validator_set.html#sui_system_validator_set_ValidatorEpochInfoEventV2" class="hash-link" aria-label="Direct link to sui_system_validator_set_ValidatorEpochInfoEventV2" title="Direct link to sui_system_validator_set_ValidatorEpochInfoEventV2">​</a></h2>
<p>V2 of ValidatorEpochInfoEvent containing more information about the validator.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>struct</b> <a href="validator_set.html#sui_system_validator_set_ValidatorEpochInfoEventV2">ValidatorEpochInfoEventV2</a> <b>has</b> <b>copy</b>, drop
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Fields</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<dl>
<dt>
epoch: u64
</dt>
<dd>
</dd>
<dt>
validator_address: <b>address</b>
</dt>
<dd>
</dd>
<dt>
reference_gas_survey_quote: u64
</dt>
<dd>
</dd>
<dt>
stake: u64
</dt>
<dd>
</dd>
<dt>
<a href="voting_power.html#sui_system_voting_power">voting_power</a>: u64
</dt>
<dd>
</dd>
<dt>
commission_rate: u64
</dt>
<dd>
</dd>
<dt>
pool_staking_reward: u64
</dt>
<dd>
</dd>
<dt>
storage_fund_staking_reward: u64
</dt>
<dd>
</dd>
<dt>
pool_token_exchange_rate: <a href="staking_pool.html#sui_system_staking_pool_PoolTokenExchangeRate">sui_system::staking_pool::PoolTokenExchangeRate</a>
</dt>
<dd>
</dd>
<dt>
tallying_rule_reporters: vector&lt;<b>address</b>&gt;
</dt>
<dd>
</dd>
<dt>
tallying_rule_global_score: u64
</dt>
<dd>
</dd>
</dl>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_ValidatorJoinEvent">Struct <code>ValidatorJoinEvent</code><a href="validator_set.html#sui_system_validator_set_ValidatorJoinEvent" class="hash-link" aria-label="Direct link to sui_system_validator_set_ValidatorJoinEvent" title="Direct link to sui_system_validator_set_ValidatorJoinEvent">​</a></h2>
<p>Event emitted every time a new validator joins the committee.
The epoch value corresponds to the first epoch this change takes place.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>struct</b> <a href="validator_set.html#sui_system_validator_set_ValidatorJoinEvent">ValidatorJoinEvent</a> <b>has</b> <b>copy</b>, drop
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Fields</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<dl>
<dt>
epoch: u64
</dt>
<dd>
</dd>
<dt>
validator_address: <b>address</b>
</dt>
<dd>
</dd>
<dt>
staking_pool_id: <a href="../sui-framework/object.html#sui_object_ID">sui::object::ID</a>
</dt>
<dd>
</dd>
</dl>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_ValidatorLeaveEvent">Struct <code>ValidatorLeaveEvent</code><a href="validator_set.html#sui_system_validator_set_ValidatorLeaveEvent" class="hash-link" aria-label="Direct link to sui_system_validator_set_ValidatorLeaveEvent" title="Direct link to sui_system_validator_set_ValidatorLeaveEvent">​</a></h2>
<p>Event emitted every time a validator leaves the committee.
The epoch value corresponds to the first epoch this change takes place.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>struct</b> <a href="validator_set.html#sui_system_validator_set_ValidatorLeaveEvent">ValidatorLeaveEvent</a> <b>has</b> <b>copy</b>, drop
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Fields</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<dl>
<dt>
epoch: u64
</dt>
<dd>
</dd>
<dt>
validator_address: <b>address</b>
</dt>
<dd>
</dd>
<dt>
staking_pool_id: <a href="../sui-framework/object.html#sui_object_ID">sui::object::ID</a>
</dt>
<dd>
</dd>
<dt>
is_voluntary: bool
</dt>
<dd>
</dd>
</dl>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_VotingPowerAdmissionStartEpochKey">Struct <code>VotingPowerAdmissionStartEpochKey</code><a href="validator_set.html#sui_system_validator_set_VotingPowerAdmissionStartEpochKey" class="hash-link" aria-label="Direct link to sui_system_validator_set_VotingPowerAdmissionStartEpochKey" title="Direct link to sui_system_validator_set_VotingPowerAdmissionStartEpochKey">​</a></h2>
<p>Key for the extra_fields bag to store the start epoch of allowing admission
of new validators based on a minimum voting power rather than a minimum stake.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>struct</b> <a href="validator_set.html#sui_system_validator_set_VotingPowerAdmissionStartEpochKey">VotingPowerAdmissionStartEpochKey</a> <b>has</b> <b>copy</b>, drop, store
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Fields</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<dl>
</dl>
</div></div></details></div>
<p><a style="scroll-margin-top:80px" id="@Constants_0"></a></p>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="constants">Constants<a href="validator_set.html#constants" class="hash-link" aria-label="Direct link to Constants" title="Direct link to Constants">​</a></h2>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_ENonValidatorInReportRecords"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_ENonValidatorInReportRecords">ENonValidatorInReportRecords</a>: u64 = 0;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_EInvalidStakeAdjustmentAmount"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_EInvalidStakeAdjustmentAmount">EInvalidStakeAdjustmentAmount</a>: u64 = 1;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_EDuplicateValidator"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_EDuplicateValidator">EDuplicateValidator</a>: u64 = 2;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_ENoPoolFound"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_ENoPoolFound">ENoPoolFound</a>: u64 = 3;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_ENotAValidator"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_ENotAValidator">ENotAValidator</a>: u64 = 4;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_EMinJoiningStakeNotReached"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_EMinJoiningStakeNotReached">EMinJoiningStakeNotReached</a>: u64 = 5;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_EAlreadyValidatorCandidate"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_EAlreadyValidatorCandidate">EAlreadyValidatorCandidate</a>: u64 = 6;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_EValidatorNotCandidate"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_EValidatorNotCandidate">EValidatorNotCandidate</a>: u64 = 7;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_ENotValidatorCandidate"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_ENotValidatorCandidate">ENotValidatorCandidate</a>: u64 = 8;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_ENotActiveOrPendingValidator"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_ENotActiveOrPendingValidator">ENotActiveOrPendingValidator</a>: u64 = 9;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_EStakingBelowThreshold"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_EStakingBelowThreshold">EStakingBelowThreshold</a>: u64 = 10;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_EValidatorAlreadyRemoved"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_EValidatorAlreadyRemoved">EValidatorAlreadyRemoved</a>: u64 = 11;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_ENotAPendingValidator"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_ENotAPendingValidator">ENotAPendingValidator</a>: u64 = 12;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_EValidatorSetEmpty"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_EValidatorSetEmpty">EValidatorSetEmpty</a>: u64 = 13;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_EInvalidCap"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_EInvalidCap">EInvalidCap</a>: u64 = 101;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_ACTIVE_VALIDATOR_ONLY"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_ACTIVE_VALIDATOR_ONLY">ACTIVE_VALIDATOR_ONLY</a>: u8 = 1;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_ACTIVE_OR_PENDING_VALIDATOR"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_ACTIVE_OR_PENDING_VALIDATOR">ACTIVE_OR_PENDING_VALIDATOR</a>: u8 = 2;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_ANY_VALIDATOR"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_ANY_VALIDATOR">ANY_VALIDATOR</a>: u8 = 3;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_BASIS_POINT_DENOMINATOR"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_BASIS_POINT_DENOMINATOR">BASIS_POINT_DENOMINATOR</a>: u64 = 10000;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_MIN_STAKING_THRESHOLD"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_MIN_STAKING_THRESHOLD">MIN_STAKING_THRESHOLD</a>: u64 = 1000000000;
</code></pre>
<p><a style="scroll-margin-top:80px" id="sui_system_validator_set_PHASE_LENGTH"></a></p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>const</b> <a href="validator_set.html#sui_system_validator_set_PHASE_LENGTH">PHASE_LENGTH</a>: u64 = 14;
</code></pre>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_new">Function <code>new</code><a href="validator_set.html#sui_system_validator_set_new" class="hash-link" aria-label="Direct link to sui_system_validator_set_new" title="Direct link to sui_system_validator_set_new">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_new">new</a>(init_active_validators: vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_new">new</a>(
    init_active_validators: vector&lt;Validator&gt;,
    ctx: &amp;<b>mut</b> TxContext,
): <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a> {
    <b>let</b> <a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a> = <a href="validator_set.html#sui_system_validator_set_calculate_total_stakes">calculate_total_stakes</a>(&amp;init_active_validators);
    <b>let</b> <b>mut</b> <a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a> = table::new(ctx);
    init_active_validators.do_ref!(|v| {
        <a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>.add(v.staking_pool_id(), v.sui_address());
    });
    <b>let</b> <b>mut</b> validators = <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a> {
        <a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>,
        <a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>: init_active_validators,
        pending_active_validators: table_vec::empty(ctx),
        pending_removals: vector[],
        <a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>,
        inactive_validators: table::new(ctx),
        validator_candidates: table::new(ctx),
        at_risk_validators: vec_map::empty(),
        extra_fields: bag::new(ctx),
    };
    <a href="voting_power.html#sui_system_voting_power_set_voting_power">voting_power::set_voting_power</a>(&amp;<b>mut</b> validators.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, <a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>);
    validators
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_request_add_validator_candidate">Function <code>request_add_validator_candidate</code><a href="validator_set.html#sui_system_validator_set_request_add_validator_candidate" class="hash-link" aria-label="Direct link to sui_system_validator_set_request_add_validator_candidate" title="Direct link to sui_system_validator_set_request_add_validator_candidate">​</a></h2>
<p>Called by <a href="sui_system.html#sui_system_sui_system">sui_system</a> to add a new validator candidate.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_add_validator_candidate">request_add_validator_candidate</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, <a href="validator.html#sui_system_validator">validator</a>: <a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_add_validator_candidate">request_add_validator_candidate</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    <a href="validator.html#sui_system_validator">validator</a>: Validator,
    ctx: &amp;<b>mut</b> TxContext,
) {
    // The next assertions are not critical <b>for</b> the protocol, but they are here to catch problematic configs earlier.
    <b>assert</b>!(
        !self.<a href="validator_set.html#sui_system_validator_set_is_duplicate_with_active_validator">is_duplicate_with_active_validator</a>(&amp;<a href="validator.html#sui_system_validator">validator</a>)
            &amp;&amp; !self.<a href="validator_set.html#sui_system_validator_set_is_duplicate_with_pending_validator">is_duplicate_with_pending_validator</a>(&amp;<a href="validator.html#sui_system_validator">validator</a>),
        <a href="validator_set.html#sui_system_validator_set_EDuplicateValidator">EDuplicateValidator</a>,
    );
    <b>let</b> validator_address = <a href="validator.html#sui_system_validator">validator</a>.sui_address();
    <b>assert</b>!(!self.validator_candidates.contains(validator_address), <a href="validator_set.html#sui_system_validator_set_EAlreadyValidatorCandidate">EAlreadyValidatorCandidate</a>);
    <b>assert</b>!(<a href="validator.html#sui_system_validator">validator</a>.is_preactive(), <a href="validator_set.html#sui_system_validator_set_EValidatorNotCandidate">EValidatorNotCandidate</a>);
    // Add <a href="validator.html#sui_system_validator">validator</a> to the candidates mapping and the pool id mappings so that users can start
    // staking with this candidate.
    self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>.add(<a href="validator.html#sui_system_validator">validator</a>.staking_pool_id(), validator_address);
    self.validator_candidates.add(<a href="validator.html#sui_system_validator">validator</a>.sui_address(), <a href="validator.html#sui_system_validator">validator</a>.wrap_v1(ctx));
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_request_remove_validator_candidate">Function <code>request_remove_validator_candidate</code><a href="validator_set.html#sui_system_validator_set_request_remove_validator_candidate" class="hash-link" aria-label="Direct link to sui_system_validator_set_request_remove_validator_candidate" title="Direct link to sui_system_validator_set_request_remove_validator_candidate">​</a></h2>
<p>Called by <a href="sui_system.html#sui_system_sui_system">sui_system</a> to remove a validator candidate, and move them to inactive_validators.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_remove_validator_candidate">request_remove_validator_candidate</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_remove_validator_candidate">request_remove_validator_candidate</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    ctx: &amp;<b>mut</b> TxContext,
) {
    <b>let</b> validator_address = ctx.sender();
    <b>assert</b>!(self.validator_candidates.contains(validator_address), <a href="validator_set.html#sui_system_validator_set_ENotValidatorCandidate">ENotValidatorCandidate</a>);
    <b>let</b> <b>mut</b> <a href="validator.html#sui_system_validator">validator</a> = self.validator_candidates.remove(validator_address).destroy();
    <b>assert</b>!(<a href="validator.html#sui_system_validator">validator</a>.is_preactive(), <a href="validator_set.html#sui_system_validator_set_EValidatorNotCandidate">EValidatorNotCandidate</a>);
    <b>let</b> staking_pool_id = <a href="validator.html#sui_system_validator">validator</a>.staking_pool_id();
    // Remove the <a href="validator.html#sui_system_validator">validator</a>&#x27;s staking pool from mappings.
    self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>.remove(staking_pool_id);
    // Deactivate the staking pool.
    <a href="validator.html#sui_system_validator">validator</a>.deactivate(ctx.epoch());
    // Add to the inactive tables.
    self.inactive_validators.add(staking_pool_id, <a href="validator.html#sui_system_validator">validator</a>.wrap_v1(ctx));
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_request_add_validator">Function <code>request_add_validator</code><a href="validator_set.html#sui_system_validator_set_request_add_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_request_add_validator" title="Direct link to sui_system_validator_set_request_add_validator">​</a></h2>
<p>Called by <a href="sui_system.html#sui_system_sui_system">sui_system</a> to add a new validator to pending_active_validators, which will be
processed at the end of epoch.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_add_validator">request_add_validator</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_add_validator">request_add_validator</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, ctx: &amp;TxContext) {
    <b>let</b> validator_address = ctx.sender();
    <b>assert</b>!(self.validator_candidates.contains(validator_address), <a href="validator_set.html#sui_system_validator_set_ENotValidatorCandidate">ENotValidatorCandidate</a>);
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = self.validator_candidates.remove(validator_address).destroy();
    <b>assert</b>!(
        !self.<a href="validator_set.html#sui_system_validator_set_is_duplicate_with_active_validator">is_duplicate_with_active_validator</a>(&amp;<a href="validator.html#sui_system_validator">validator</a>)
            &amp;&amp; !self.<a href="validator_set.html#sui_system_validator_set_is_duplicate_with_pending_validator">is_duplicate_with_pending_validator</a>(&amp;<a href="validator.html#sui_system_validator">validator</a>),
        <a href="validator_set.html#sui_system_validator_set_EDuplicateValidator">EDuplicateValidator</a>,
    );
    <b>assert</b>!(<a href="validator.html#sui_system_validator">validator</a>.is_preactive(), <a href="validator_set.html#sui_system_validator_set_EValidatorNotCandidate">EValidatorNotCandidate</a>);
    <b>assert</b>!(self.<a href="validator_set.html#sui_system_validator_set_can_join">can_join</a>(<a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>(), ctx), <a href="validator_set.html#sui_system_validator_set_EMinJoiningStakeNotReached">EMinJoiningStakeNotReached</a>);
    self.pending_active_validators.push_back(<a href="validator.html#sui_system_validator">validator</a>);
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_can_join">Function <code>can_join</code><a href="validator_set.html#sui_system_validator_set_can_join" class="hash-link" aria-label="Direct link to sui_system_validator_set_can_join" title="Direct link to sui_system_validator_set_can_join">​</a></h2>
<p>Return <b>true</b> if a  candidate validator with stake will have sufficeint voting power to join the validator set</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_can_join">can_join</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, stake: u64, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): bool
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_can_join">can_join</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, stake: u64, ctx: &amp;TxContext): bool {
    <b>let</b> (min_joining_voting_power, _, _) = self.<a href="validator_set.html#sui_system_validator_set_get_voting_power_thresholds">get_voting_power_thresholds</a>(ctx);
    // <b>if</b> the <a href="validator.html#sui_system_validator">validator</a> will have at least `min_joining_voting_power` after joining, they can join.
    // this formula comes from SIP-39: https://github.com/sui-foundation/sips/blob/main/sips/sip-39.md
    <b>let</b> future_total_stake = self.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a> + stake;
    <b>let</b> future_validator_voting_power = <a href="voting_power.html#sui_system_voting_power_derive_raw_voting_power">voting_power::derive_raw_voting_power</a>(
        stake,
        future_total_stake,
    );
    future_validator_voting_power &gt;= min_joining_voting_power
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_voting_power_thresholds">Function <code>get_voting_power_thresholds</code><a href="validator_set.html#sui_system_validator_set_get_voting_power_thresholds" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_voting_power_thresholds" title="Direct link to sui_system_validator_set_get_voting_power_thresholds">​</a></h2>
<p>return (min, low, very low voting power) thresholds</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_voting_power_thresholds">get_voting_power_thresholds</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): (u64, u64, u64)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_voting_power_thresholds">get_voting_power_thresholds</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, ctx: &amp;TxContext): (u64, u64, u64) {
    <b>let</b> start_epoch = {
        <b>let</b> key = <a href="validator_set.html#sui_system_validator_set_VotingPowerAdmissionStartEpochKey">VotingPowerAdmissionStartEpochKey</a>();
        <b>if</b> (self.extra_fields.contains(key)) self.extra_fields[key]
        <b>else</b> ctx.epoch() + 1 // will give us the phase 1 values
    };
    // these numbers come from SIP-39: https://github.com/sui-foundation/sips/blob/main/sips/sip-39.md
    <b>let</b> curr_epoch = ctx.epoch();
    <b>if</b> (curr_epoch &lt; start_epoch + <a href="validator_set.html#sui_system_validator_set_PHASE_LENGTH">PHASE_LENGTH</a>) (12, 8, 4) // phase 1
    <b>else</b> <b>if</b> (curr_epoch &lt; start_epoch + (2 * <a href="validator_set.html#sui_system_validator_set_PHASE_LENGTH">PHASE_LENGTH</a>)) (6, 4, 2) // phase 2
    <b>else</b> (3, 2, 1) // phase 3
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_assert_no_pending_or_active_duplicates">Function <code>assert_no_pending_or_active_duplicates</code><a href="validator_set.html#sui_system_validator_set_assert_no_pending_or_active_duplicates" class="hash-link" aria-label="Direct link to sui_system_validator_set_assert_no_pending_or_active_duplicates" title="Direct link to sui_system_validator_set_assert_no_pending_or_active_duplicates">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_assert_no_pending_or_active_duplicates">assert_no_pending_or_active_duplicates</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, <a href="validator.html#sui_system_validator">validator</a>: &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_assert_no_pending_or_active_duplicates">assert_no_pending_or_active_duplicates</a>(
    self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    <a href="validator.html#sui_system_validator">validator</a>: &amp;Validator,
) {
    // Validator here must be active or pending, and thus must be identified <b>as</b> duplicate exactly once.
    <b>assert</b>!(
        <a href="validator_set.html#sui_system_validator_set_count_duplicates_vec">count_duplicates_vec</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, <a href="validator.html#sui_system_validator">validator</a>) +
            <a href="validator_set.html#sui_system_validator_set_count_duplicates_tablevec">count_duplicates_tablevec</a>(&amp;self.pending_active_validators, <a href="validator.html#sui_system_validator">validator</a>) == 1,
        <a href="validator_set.html#sui_system_validator_set_EDuplicateValidator">EDuplicateValidator</a>,
    );
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_request_remove_validator">Function <code>request_remove_validator</code><a href="validator_set.html#sui_system_validator_set_request_remove_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_request_remove_validator" title="Direct link to sui_system_validator_set_request_remove_validator">​</a></h2>
<p>Called by <a href="sui_system.html#sui_system_sui_system">sui_system</a>, to remove a validator.
The index of the validator is added to pending_removals and
will be processed at the end of epoch.
Only an active validator can request to be removed.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_remove_validator">request_remove_validator</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_remove_validator">request_remove_validator</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, ctx: &amp;TxContext) {
    <b>let</b> validator_address = ctx.sender();
    <b>let</b> validator_index = <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(
        &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>,
        validator_address,
    ).destroy_or!(<b>abort</b> <a href="validator_set.html#sui_system_validator_set_ENotAValidator">ENotAValidator</a>);
    <b>assert</b>!(!self.pending_removals.contains(&amp;validator_index), <a href="validator_set.html#sui_system_validator_set_EValidatorAlreadyRemoved">EValidatorAlreadyRemoved</a>);
    self.pending_removals.push_back(validator_index);
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_request_add_stake">Function <code>request_add_stake</code><a href="validator_set.html#sui_system_validator_set_request_add_stake" class="hash-link" aria-label="Direct link to sui_system_validator_set_request_add_stake" title="Direct link to sui_system_validator_set_request_add_stake">​</a></h2>
<p>Called by <a href="sui_system.html#sui_system_sui_system">sui_system</a>, to add a new stake to the validator.
This request is added to the validator&#x27;s staking pool&#x27;s pending stake entries, processed at the end
of the epoch.
Aborts in case the staking amount is smaller than MIN_STAKING_THRESHOLD</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_add_stake">request_add_stake</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_address: <b>address</b>, stake: <a href="../sui/balance.html#sui_balance_Balance">sui::balance::Balance</a>&lt;<a href="../sui/sui.html#sui_sui_SUI">sui::sui::SUI</a>&gt;, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): <a href="staking_pool.html#sui_system_staking_pool_StakedSui">sui_system::staking_pool::StakedSui</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_add_stake">request_add_stake</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    validator_address: <b>address</b>,
    stake: Balance&lt;SUI&gt;,
    ctx: &amp;<b>mut</b> TxContext,
): StakedSui {
    <b>let</b> sui_amount = stake.value();
    <b>assert</b>!(sui_amount &gt;= <a href="validator_set.html#sui_system_validator_set_MIN_STAKING_THRESHOLD">MIN_STAKING_THRESHOLD</a>, <a href="validator_set.html#sui_system_validator_set_EStakingBelowThreshold">EStakingBelowThreshold</a>);
    self
        .<a href="validator_set.html#sui_system_validator_set_get_candidate_or_active_validator_mut">get_candidate_or_active_validator_mut</a>(validator_address)
        .<a href="validator_set.html#sui_system_validator_set_request_add_stake">request_add_stake</a>(stake, ctx.sender(), ctx)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_request_withdraw_stake">Function <code>request_withdraw_stake</code><a href="validator_set.html#sui_system_validator_set_request_withdraw_stake" class="hash-link" aria-label="Direct link to sui_system_validator_set_request_withdraw_stake" title="Direct link to sui_system_validator_set_request_withdraw_stake">​</a></h2>
<p>Called by <a href="sui_system.html#sui_system_sui_system">sui_system</a>, to withdraw some share of a stake from the validator. The share to withdraw
is denoted by principal_withdraw_amount. One of two things occurs in this function:</p>
<ol>
<li>If the staked_sui is staked with an active validator, the request is added to the validator&#x27;s
staking pool&#x27;s pending stake withdraw entries, processed at the end of the epoch.</li>
<li>If the staked_sui was staked with a validator that is no longer active,
the stake and any rewards corresponding to it will be immediately processed.</li>
</ol>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_withdraw_stake">request_withdraw_stake</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, staked_sui: <a href="staking_pool.html#sui_system_staking_pool_StakedSui">sui_system::staking_pool::StakedSui</a>, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): <a href="../sui/balance.html#sui_balance_Balance">sui::balance::Balance</a>&lt;<a href="../sui/sui.html#sui_sui_SUI">sui::sui::SUI</a>&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_withdraw_stake">request_withdraw_stake</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    staked_sui: StakedSui,
    ctx: &amp;TxContext,
): Balance&lt;SUI&gt; {
    <b>let</b> staking_pool_id = staked_sui.pool_id();
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <b>if</b> (self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>.contains(staking_pool_id)) {
        // This is an active <a href="validator.html#sui_system_validator">validator</a>.
        <b>let</b> validator_address = self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>[staked_sui.pool_id()];
        self.<a href="validator_set.html#sui_system_validator_set_get_candidate_or_active_validator_mut">get_candidate_or_active_validator_mut</a>(validator_address)
    } <b>else</b> {
        // This is an inactive pool.
        <b>assert</b>!(self.inactive_validators.contains(staking_pool_id), <a href="validator_set.html#sui_system_validator_set_ENoPoolFound">ENoPoolFound</a>);
        self.inactive_validators[staking_pool_id].load_validator_maybe_upgrade()
    };
    <a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_request_withdraw_stake">request_withdraw_stake</a>(staked_sui, ctx)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_convert_to_fungible_staked_sui">Function <code>convert_to_fungible_staked_sui</code><a href="validator_set.html#sui_system_validator_set_convert_to_fungible_staked_sui" class="hash-link" aria-label="Direct link to sui_system_validator_set_convert_to_fungible_staked_sui" title="Direct link to sui_system_validator_set_convert_to_fungible_staked_sui">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_convert_to_fungible_staked_sui">convert_to_fungible_staked_sui</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, staked_sui: <a href="staking_pool.html#sui_system_staking_pool_StakedSui">sui_system::staking_pool::StakedSui</a>, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): <a href="staking_pool.html#sui_system_staking_pool_FungibleStakedSui">sui_system::staking_pool::FungibleStakedSui</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_convert_to_fungible_staked_sui">convert_to_fungible_staked_sui</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    staked_sui: StakedSui,
    ctx: &amp;<b>mut</b> TxContext,
): FungibleStakedSui {
    <b>let</b> staking_pool_id = staked_sui.pool_id();
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <b>if</b> (self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>.contains(staking_pool_id)) {
        // This is an active <a href="validator.html#sui_system_validator">validator</a>.
        <b>let</b> validator_address = self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>[staking_pool_id];
        self.<a href="validator_set.html#sui_system_validator_set_get_candidate_or_active_validator_mut">get_candidate_or_active_validator_mut</a>(validator_address)
    } <b>else</b> {
        // This is an inactive pool.
        <b>assert</b>!(self.inactive_validators.contains(staking_pool_id), <a href="validator_set.html#sui_system_validator_set_ENoPoolFound">ENoPoolFound</a>);
        self.inactive_validators[staking_pool_id].load_validator_maybe_upgrade()
    };
    <a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_convert_to_fungible_staked_sui">convert_to_fungible_staked_sui</a>(staked_sui, ctx)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_redeem_fungible_staked_sui">Function <code>redeem_fungible_staked_sui</code><a href="validator_set.html#sui_system_validator_set_redeem_fungible_staked_sui" class="hash-link" aria-label="Direct link to sui_system_validator_set_redeem_fungible_staked_sui" title="Direct link to sui_system_validator_set_redeem_fungible_staked_sui">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_redeem_fungible_staked_sui">redeem_fungible_staked_sui</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, fungible_staked_sui: <a href="staking_pool.html#sui_system_staking_pool_FungibleStakedSui">sui_system::staking_pool::FungibleStakedSui</a>, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): <a href="../sui/balance.html#sui_balance_Balance">sui::balance::Balance</a>&lt;<a href="../sui/sui.html#sui_sui_SUI">sui::sui::SUI</a>&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_redeem_fungible_staked_sui">redeem_fungible_staked_sui</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    fungible_staked_sui: FungibleStakedSui,
    ctx: &amp;TxContext,
): Balance&lt;SUI&gt; {
    <b>let</b> staking_pool_id = fungible_staked_sui.pool_id();
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <b>if</b> (self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>.contains(staking_pool_id)) {
        // This is an active <a href="validator.html#sui_system_validator">validator</a>.
        <b>let</b> validator_address = self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>[staking_pool_id];
        self.<a href="validator_set.html#sui_system_validator_set_get_candidate_or_active_validator_mut">get_candidate_or_active_validator_mut</a>(validator_address)
    } <b>else</b> {
        // This is an inactive pool.
        <b>assert</b>!(self.inactive_validators.contains(staking_pool_id), <a href="validator_set.html#sui_system_validator_set_ENoPoolFound">ENoPoolFound</a>);
        self.inactive_validators[staking_pool_id].load_validator_maybe_upgrade()
    };
    <a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_redeem_fungible_staked_sui">redeem_fungible_staked_sui</a>(fungible_staked_sui, ctx)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_request_set_commission_rate">Function <code>request_set_commission_rate</code><a href="validator_set.html#sui_system_validator_set_request_set_commission_rate" class="hash-link" aria-label="Direct link to sui_system_validator_set_request_set_commission_rate" title="Direct link to sui_system_validator_set_request_set_commission_rate">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_set_commission_rate">request_set_commission_rate</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, new_commission_rate: u64, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_request_set_commission_rate">request_set_commission_rate</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    new_commission_rate: u64,
    ctx: &amp;TxContext,
) {
    <b>let</b> validator_address = ctx.sender();
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <a href="validator_set.html#sui_system_validator_set_get_validator_mut">get_validator_mut</a>(&amp;<b>mut</b> self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, validator_address);
    <a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_request_set_commission_rate">request_set_commission_rate</a>(new_commission_rate);
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_advance_epoch">Function <code>advance_epoch</code><a href="validator_set.html#sui_system_validator_set_advance_epoch" class="hash-link" aria-label="Direct link to sui_system_validator_set_advance_epoch" title="Direct link to sui_system_validator_set_advance_epoch">​</a></h2>
<p>Update the validator set at the end of epoch.
It does the following things:</p>
<ol>
<li>Distribute stake award.</li>
<li>Process pending stake deposits and withdraws for each validator (adjust_stake).</li>
<li>Process pending stake deposits, and withdraws.</li>
<li>Process pending validator application and withdraws.</li>
<li>At the end, we calculate the total stake for the new epoch.</li>
</ol>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_advance_epoch">advance_epoch</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, computation_reward: &amp;<b>mut</b> <a href="../sui/balance.html#sui_balance_Balance">sui::balance::Balance</a>&lt;<a href="../sui/sui.html#sui_sui_SUI">sui::sui::SUI</a>&gt;, storage_fund_reward: &amp;<b>mut</b> <a href="../sui/balance.html#sui_balance_Balance">sui::balance::Balance</a>&lt;<a href="../sui/sui.html#sui_sui_SUI">sui::sui::SUI</a>&gt;, validator_report_records: &amp;<b>mut</b> <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;<b>address</b>, <a href="../sui/vec_set.html#sui_vec_set_VecSet">sui::vec_set::VecSet</a>&lt;<b>address</b>&gt;&gt;, reward_slashing_rate: u64, low_stake_grace_period: u64, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_advance_epoch">advance_epoch</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    computation_reward: &amp;<b>mut</b> Balance&lt;SUI&gt;,
    storage_fund_reward: &amp;<b>mut</b> Balance&lt;SUI&gt;,
    validator_report_records: &amp;<b>mut</b> VecMap&lt;<b>address</b>, VecSet&lt;<b>address</b>&gt;&gt;,
    reward_slashing_rate: u64,
    low_stake_grace_period: u64,
    ctx: &amp;<b>mut</b> TxContext,
) {
    <b>let</b> new_epoch = ctx.epoch() + 1;
    <b>let</b> total_voting_power = <a href="voting_power.html#sui_system_voting_power_total_voting_power">voting_power::total_voting_power</a>();
    // switch to using voting power based admission, <b>if</b> we are not already using it
    <b>let</b> key = <a href="validator_set.html#sui_system_validator_set_VotingPowerAdmissionStartEpochKey">VotingPowerAdmissionStartEpochKey</a>();
    <b>if</b> (!self.extra_fields.contains(key)) self.extra_fields.add(key, ctx.epoch());
    // Compute the reward distribution without taking into account the tallying rule slashing.
    <b>let</b> (
        unadjusted_staking_reward_amounts,
        unadjusted_storage_fund_reward_amounts,
    ) = <a href="validator_set.html#sui_system_validator_set_compute_unadjusted_reward_distribution">compute_unadjusted_reward_distribution</a>(
        &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>,
        total_voting_power,
        computation_reward.value(),
        storage_fund_reward.value(),
    );
    // Use the tallying rule report records <b>for</b> the epoch to compute validators that will be
    // punished.
    <b>let</b> slashed_validators = self.<a href="validator_set.html#sui_system_validator_set_compute_slashed_validators">compute_slashed_validators</a>(*validator_report_records);
    <b>let</b> total_slashed_validator_voting_power = <a href="validator_set.html#sui_system_validator_set_sum_voting_power_by_addresses">sum_voting_power_by_addresses</a>(
        &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>,
        &amp;slashed_validators,
    );
    // Compute the reward adjustments of slashed validators, to be taken into
    // account in adjusted reward computation.
    <b>let</b> (
        total_staking_reward_adjustment,
        individual_staking_reward_adjustments,
        total_storage_fund_reward_adjustment,
        individual_storage_fund_reward_adjustments,
    ) = <a href="validator_set.html#sui_system_validator_set_compute_reward_adjustments">compute_reward_adjustments</a>(
        <a href="validator_set.html#sui_system_validator_set_get_validator_indices">get_validator_indices</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, &amp;slashed_validators),
        reward_slashing_rate,
        &amp;unadjusted_staking_reward_amounts,
        &amp;unadjusted_storage_fund_reward_amounts,
    );
    // Compute the adjusted amounts of stake each <a href="validator.html#sui_system_validator">validator</a> should get given the tallying rule
    // reward adjustments we computed before.
    // `<a href="validator_set.html#sui_system_validator_set_compute_adjusted_reward_distribution">compute_adjusted_reward_distribution</a>` must be called before `<a href="validator_set.html#sui_system_validator_set_distribute_reward">distribute_reward</a>` and `<a href="validator_set.html#sui_system_validator_set_adjust_stake_and_gas_price">adjust_stake_and_gas_price</a>` to
    // make sure we are using the current epoch&#x27;s stake information to compute reward distribution.
    <b>let</b> (
        adjusted_staking_reward_amounts,
        adjusted_storage_fund_reward_amounts,
    ) = <a href="validator_set.html#sui_system_validator_set_compute_adjusted_reward_distribution">compute_adjusted_reward_distribution</a>(
        &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>,
        total_voting_power,
        total_slashed_validator_voting_power,
        unadjusted_staking_reward_amounts,
        unadjusted_storage_fund_reward_amounts,
        total_staking_reward_adjustment,
        individual_staking_reward_adjustments,
        total_storage_fund_reward_adjustment,
        individual_storage_fund_reward_adjustments,
    );
    // Distribute the rewards before adjusting stake so that we immediately start compounding
    // the rewards <b>for</b> validators and stakers.
    <a href="validator_set.html#sui_system_validator_set_distribute_reward">distribute_reward</a>(
        &amp;<b>mut</b> self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>,
        &amp;adjusted_staking_reward_amounts,
        &amp;adjusted_storage_fund_reward_amounts,
        computation_reward,
        storage_fund_reward,
        ctx,
    );
    <a href="validator_set.html#sui_system_validator_set_adjust_stake_and_gas_price">adjust_stake_and_gas_price</a>(&amp;<b>mut</b> self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>);
    <a href="validator_set.html#sui_system_validator_set_process_pending_stakes_and_withdraws">process_pending_stakes_and_withdraws</a>(&amp;<b>mut</b> self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, ctx);
    // Emit events after we have processed all the rewards distribution and pending stakes.
    <a href="validator_set.html#sui_system_validator_set_emit_validator_epoch_events">emit_validator_epoch_events</a>(
        new_epoch,
        &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>,
        &amp;adjusted_staking_reward_amounts,
        &amp;adjusted_storage_fund_reward_amounts,
        validator_report_records,
        &amp;slashed_validators,
    );
    self.<a href="validator_set.html#sui_system_validator_set_process_pending_removals">process_pending_removals</a>(validator_report_records, ctx);
    // kick low stake validators out.
    <b>let</b> new_total_stake = self.<a href="validator_set.html#sui_system_validator_set_update_validator_positions_and_calculate_total_stake">update_validator_positions_and_calculate_total_stake</a>(
        low_stake_grace_period,
        validator_report_records,
        ctx,
    );
    self.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a> = new_total_stake;
    <a href="voting_power.html#sui_system_voting_power_set_voting_power">voting_power::set_voting_power</a>(&amp;<b>mut</b> self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, new_total_stake);
    // At this point, self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a> are updated <b>for</b> next epoch.
    // Now we process the staged <a href="validator.html#sui_system_validator">validator</a> metadata.
    self.<a href="validator_set.html#sui_system_validator_set_effectuate_staged_metadata">effectuate_staged_metadata</a>();
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_update_validator_positions_and_calculate_total_stake">Function <code>update_validator_positions_and_calculate_total_stake</code><a href="validator_set.html#sui_system_validator_set_update_validator_positions_and_calculate_total_stake" class="hash-link" aria-label="Direct link to sui_system_validator_set_update_validator_positions_and_calculate_total_stake" title="Direct link to sui_system_validator_set_update_validator_positions_and_calculate_total_stake">​</a></h2>
<p>This function does the following:</p>
<ul>
<li>removes validators from at_risk group if their voting power is above the LOW threshold</li>
<li>increments the number of epochs a validator has been below the LOW threshold but above the
VERY LOW threshold</li>
<li>removes validators from the active set if they have been below the LOW threshold for more than
low_stake_grace_period epochs</li>
<li>removes validators from the active set immediately if they are below the VERY LOW threshold</li>
<li>activates pending validators if they have sufficient voting power</li>
</ul>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_update_validator_positions_and_calculate_total_stake">update_validator_positions_and_calculate_total_stake</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, low_stake_grace_period: u64, validator_report_records: &amp;<b>mut</b> <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;<b>address</b>, <a href="../sui/vec_set.html#sui_vec_set_VecSet">sui::vec_set::VecSet</a>&lt;<b>address</b>&gt;&gt;, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_update_validator_positions_and_calculate_total_stake">update_validator_positions_and_calculate_total_stake</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    low_stake_grace_period: u64,
    validator_report_records: &amp;<b>mut</b> VecMap&lt;<b>address</b>, VecSet&lt;<b>address</b>&gt;&gt;,
    ctx: &amp;<b>mut</b> TxContext,
): u64 {
    // take all pending validators out of the tablevec and put them in a local vector
    <b>let</b> pending_active_validators = vector::tabulate!(
        self.pending_active_validators.length(),
        |_| self.pending_active_validators.pop_back(),
    );
    // Note: we count the total stake of pending validators <b>as</b> well!
    <b>let</b> pending_total_stake = <a href="validator_set.html#sui_system_validator_set_calculate_total_stakes">calculate_total_stakes</a>(&amp;pending_active_validators);
    <b>let</b> initial_total_stake = <a href="validator_set.html#sui_system_validator_set_calculate_total_stakes">calculate_total_stakes</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>) + pending_total_stake;
    <b>let</b> (
        min_joining_voting_power_threshold,
        low_voting_power_threshold,
        very_low_voting_power_threshold,
    ) = self.<a href="validator_set.html#sui_system_validator_set_get_voting_power_thresholds">get_voting_power_thresholds</a>(ctx);
    // Iterate through all the active validators, record their low stake status, and kick them out <b>if</b> the condition is met.
    <b>let</b> <b>mut</b> total_removed_stake = 0; // amount of stake to remove due to departed_validators
    <b>let</b> <b>mut</b> i = self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>.length();
    <b>while</b> (i &gt; 0) {
        i = i - 1;
        <b>let</b> validator_ref = &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>[i];
        <b>let</b> validator_address = validator_ref.sui_address();
        <b>let</b> validator_stake = validator_ref.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>();
        // calculate the voting power <b>for</b> this <a href="validator.html#sui_system_validator">validator</a> in the next epoch <b>if</b> no validators are removed
        // <b>if</b> one of more low stake validators are removed, it&#x27;s possible this <a href="validator.html#sui_system_validator">validator</a> will have higher voting power--that&#x27;s ok.
        <b>let</b> <a href="voting_power.html#sui_system_voting_power">voting_power</a> = <a href="voting_power.html#sui_system_voting_power_derive_raw_voting_power">voting_power::derive_raw_voting_power</a>(
            validator_stake,
            initial_total_stake,
        );
        // SIP-39: a <a href="validator.html#sui_system_validator">validator</a> can remain indefinitely with a voting power ≥ LOW_VOTING_POWER_THRESHOLD
        <b>if</b> (<a href="voting_power.html#sui_system_voting_power">voting_power</a> &gt;= low_voting_power_threshold) {
            // The <a href="validator.html#sui_system_validator">validator</a> is safe. We remove their <b>entry</b> from the at_risk map <b>if</b> there exists one.
            <b>if</b> (self.at_risk_validators.contains(&amp;validator_address)) {
                self.at_risk_validators.remove(&amp;validator_address);
            }
            // SIP-39: <b>as</b> soon <b>as</b> the <a href="validator.html#sui_system_validator">validator</a>’s voting power falls to VERY_LOW_VOTING_POWER_THRESHOLD,
            //      they are on probation and must acquire sufficient stake to recover to voting power
        } <b>else</b> <b>if</b> (<a href="voting_power.html#sui_system_voting_power">voting_power</a> &gt;= very_low_voting_power_threshold) {
            // The stake is a bit below the threshold so we increment the <b>entry</b> of the <a href="validator.html#sui_system_validator">validator</a> in the map.
            <b>let</b> new_low_stake_period = <b>if</b> (self.at_risk_validators.contains(&amp;validator_address)) {
                <b>let</b> num_epochs = &amp;<b>mut</b> self.at_risk_validators[&amp;validator_address];
                *num_epochs = *num_epochs + 1;
                *num_epochs
            } <b>else</b> {
                self.at_risk_validators.insert(validator_address, 1);
                1
            };
            // If the grace period <b>has</b> passed, the <a href="validator.html#sui_system_validator">validator</a> <b>has</b> to leave us.
            <b>if</b> (new_low_stake_period &gt; low_stake_grace_period) {
                <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>.remove(i);
                <b>let</b> removed_stake = self.<a href="validator_set.html#sui_system_validator_set_process_validator_departure">process_validator_departure</a>(
                    <a href="validator.html#sui_system_validator">validator</a>,
                    validator_report_records,
                    <b>false</b>, // the <a href="validator.html#sui_system_validator">validator</a> is kicked out involuntarily
                    ctx,
                );
                total_removed_stake = total_removed_stake + removed_stake;
            }
            // SIP-39: at the end of an epoch when <a href="validator_set.html#sui_system_validator_set_new">new</a> voting powers are computed based on stake changes,
            //      any <a href="validator.html#sui_system_validator">validator</a> with VOTING_POWER &lt; VERY_LOW_VOTING_POWER_THRESHOLD will be removed
        } <b>else</b> {
            // The <a href="validator.html#sui_system_validator">validator</a>&#x27;s stake is lower than the very low threshold so we kick them out immediately.
            <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>.remove(i);
            <b>let</b> removed_stake = self.<a href="validator_set.html#sui_system_validator_set_process_validator_departure">process_validator_departure</a>(
                <a href="validator.html#sui_system_validator">validator</a>,
                validator_report_records,
                <b>false</b>, // the <a href="validator.html#sui_system_validator">validator</a> is kicked out involuntarily
                ctx,
            );
            total_removed_stake = total_removed_stake + removed_stake;
        }
    };
    // check that pending validators still have sufficient stake to be added. this was checked at
    // the time of <a href="validator_set.html#sui_system_validator_set_request_add_validator">request_add_validator</a>, but stake may have been withdrawn, or stakes of other
    // validators may have increased significantly
    pending_active_validators.do!(|<b>mut</b> <a href="validator.html#sui_system_validator">validator</a>| {
        <b>let</b> validator_stake = <a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>();
        <b>let</b> <a href="voting_power.html#sui_system_voting_power">voting_power</a> = <a href="voting_power.html#sui_system_voting_power_derive_raw_voting_power">voting_power::derive_raw_voting_power</a>(
            validator_stake,
            initial_total_stake,
        );
        <b>if</b> (<a href="voting_power.html#sui_system_voting_power">voting_power</a> &gt;= min_joining_voting_power_threshold) {
            <a href="validator.html#sui_system_validator">validator</a>.activate(ctx.epoch());
            event::emit(<a href="validator_set.html#sui_system_validator_set_ValidatorJoinEvent">ValidatorJoinEvent</a> {
                epoch: ctx.epoch(),
                validator_address: <a href="validator.html#sui_system_validator">validator</a>.sui_address(),
                staking_pool_id: <a href="validator.html#sui_system_validator">validator</a>.staking_pool_id(),
            });
            self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>.push_back(<a href="validator.html#sui_system_validator">validator</a>);
        } <b>else</b> {
            // <b>return</b> <a href="validator.html#sui_system_validator">validator</a> object to the candidate pool. want to do this directly instead of
            // calling <a href="validator_set.html#sui_system_validator_set_request_add_validator_candidate">request_add_validator_candidate</a> because <a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a> already <b>has</b> an
            // <b>entry</b> <b>for</b> this <a href="validator.html#sui_system_validator">validator</a>, and the duplicate checks are redundant
            self
                .validator_candidates
                .add(
                    <a href="validator.html#sui_system_validator">validator</a>.sui_address(),
                    <a href="validator.html#sui_system_validator">validator</a>.wrap_v1(ctx),
                );
            total_removed_stake = total_removed_stake + validator_stake;
        }
    });
    // <a href="validator_set.html#sui_system_validator_set_new">new</a> total stake is the initial total minus the amount removed via validators we kicked out
    initial_total_stake - total_removed_stake
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_effectuate_staged_metadata">Function <code>effectuate_staged_metadata</code><a href="validator_set.html#sui_system_validator_set_effectuate_staged_metadata" class="hash-link" aria-label="Direct link to sui_system_validator_set_effectuate_staged_metadata" title="Direct link to sui_system_validator_set_effectuate_staged_metadata">​</a></h2>
<p>Effectuate pending next epoch metadata if they are staged.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_effectuate_staged_metadata">effectuate_staged_metadata</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_effectuate_staged_metadata">effectuate_staged_metadata</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>) {
    self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>.do_mut!(|v| v.<a href="validator_set.html#sui_system_validator_set_effectuate_staged_metadata">effectuate_staged_metadata</a>());
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_derive_reference_gas_price">Function <code>derive_reference_gas_price</code><a href="validator_set.html#sui_system_validator_set_derive_reference_gas_price" class="hash-link" aria-label="Direct link to sui_system_validator_set_derive_reference_gas_price" title="Direct link to sui_system_validator_set_derive_reference_gas_price">​</a></h2>
<p>Called by <a href="sui_system.html#sui_system_sui_system">sui_system</a> to derive reference gas price for the new epoch.
Derive the reference gas price based on the gas price quote submitted by each validator.
The returned gas price should be greater than or equal to 2/3 of the validators submitted
gas price, weighted by stake.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_derive_reference_gas_price">derive_reference_gas_price</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_derive_reference_gas_price">derive_reference_gas_price</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>): u64 {
    <b>let</b> entries = self
        .<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>
        .map_ref!(|v| pq::new_entry(v.gas_price(), v.<a href="voting_power.html#sui_system_voting_power">voting_power</a>()));
    // Build a priority queue that will pop entries with gas price from the highest to the lowest.
    <b>let</b> <b>mut</b> pq = pq::new(entries);
    <b>let</b> <b>mut</b> sum = 0;
    <b>let</b> threshold = <a href="voting_power.html#sui_system_voting_power_total_voting_power">voting_power::total_voting_power</a>() - <a href="voting_power.html#sui_system_voting_power_quorum_threshold">voting_power::quorum_threshold</a>();
    <b>let</b> <b>mut</b> result = 0;
    <b>while</b> (sum &lt; threshold) {
        <b>let</b> (gas_price, <a href="voting_power.html#sui_system_voting_power">voting_power</a>) = pq.pop_max();
        result = gas_price;
        sum = sum + <a href="voting_power.html#sui_system_voting_power">voting_power</a>;
    };
    result
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_total_stake">Function <code>total_stake</code><a href="validator_set.html#sui_system_validator_set_total_stake" class="hash-link" aria-label="Direct link to sui_system_validator_set_total_stake" title="Direct link to sui_system_validator_set_total_stake">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>): u64 {
    self.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_validator_total_stake_amount">Function <code>validator_total_stake_amount</code><a href="validator_set.html#sui_system_validator_set_validator_total_stake_amount" class="hash-link" aria-label="Direct link to sui_system_validator_set_validator_total_stake_amount" title="Direct link to sui_system_validator_set_validator_total_stake_amount">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_total_stake_amount">validator_total_stake_amount</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_address: <b>address</b>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_total_stake_amount">validator_total_stake_amount</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, validator_address: <b>address</b>): u64 {
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <a href="validator_set.html#sui_system_validator_set_get_validator_ref">get_validator_ref</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, validator_address);
    <a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_validator_stake_amount">Function <code>validator_stake_amount</code><a href="validator_set.html#sui_system_validator_set_validator_stake_amount" class="hash-link" aria-label="Direct link to sui_system_validator_set_validator_stake_amount" title="Direct link to sui_system_validator_set_validator_stake_amount">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_stake_amount">validator_stake_amount</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_address: <b>address</b>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_stake_amount">validator_stake_amount</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, validator_address: <b>address</b>): u64 {
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <a href="validator_set.html#sui_system_validator_set_get_validator_ref">get_validator_ref</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, validator_address);
    <a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_validator_voting_power">Function <code>validator_voting_power</code><a href="validator_set.html#sui_system_validator_set_validator_voting_power" class="hash-link" aria-label="Direct link to sui_system_validator_set_validator_voting_power" title="Direct link to sui_system_validator_set_validator_voting_power">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_voting_power">validator_voting_power</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_address: <b>address</b>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_voting_power">validator_voting_power</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, validator_address: <b>address</b>): u64 {
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <a href="validator_set.html#sui_system_validator_set_get_validator_ref">get_validator_ref</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, validator_address);
    <a href="validator.html#sui_system_validator">validator</a>.<a href="voting_power.html#sui_system_voting_power">voting_power</a>()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_validator_staking_pool_id">Function <code>validator_staking_pool_id</code><a href="validator_set.html#sui_system_validator_set_validator_staking_pool_id" class="hash-link" aria-label="Direct link to sui_system_validator_set_validator_staking_pool_id" title="Direct link to sui_system_validator_set_validator_staking_pool_id">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_staking_pool_id">validator_staking_pool_id</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_address: <b>address</b>): <a href="../sui-framework/object.html#sui_object_ID">sui::object::ID</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_staking_pool_id">validator_staking_pool_id</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, validator_address: <b>address</b>): ID {
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <a href="validator_set.html#sui_system_validator_set_get_validator_ref">get_validator_ref</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, validator_address);
    <a href="validator.html#sui_system_validator">validator</a>.staking_pool_id()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_staking_pool_mappings">Function <code>staking_pool_mappings</code><a href="validator_set.html#sui_system_validator_set_staking_pool_mappings" class="hash-link" aria-label="Direct link to sui_system_validator_set_staking_pool_mappings" title="Direct link to sui_system_validator_set_staking_pool_mappings">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>): &amp;<a href="../sui/table.html#sui_table_Table">sui::table::Table</a>&lt;<a href="../sui-framework/object.html#sui_object_ID">sui::object::ID</a>, <b>address</b>&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>): &amp;Table&lt;ID, <b>address</b>&gt; {
    &amp;self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_validator_address_by_pool_id">Function <code>validator_address_by_pool_id</code><a href="validator_set.html#sui_system_validator_set_validator_address_by_pool_id" class="hash-link" aria-label="Direct link to sui_system_validator_set_validator_address_by_pool_id" title="Direct link to sui_system_validator_set_validator_address_by_pool_id">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_address_by_pool_id">validator_address_by_pool_id</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, pool_id: &amp;<a href="../sui-framework/object.html#sui_object_ID">sui::object::ID</a>): <b>address</b>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_validator_address_by_pool_id">validator_address_by_pool_id</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, pool_id: &amp;ID): <b>address</b> {
    // If the pool id is recorded in the mapping, then it must be either candidate or active.
    <b>if</b> (self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>.contains(*pool_id)) {
        self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>[*pool_id]
    } <b>else</b> {
        // otherwise it&#x27;s inactive
        self.inactive_validators[*pool_id].load_validator_maybe_upgrade().sui_address()
    }
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_pool_exchange_rates">Function <code>pool_exchange_rates</code><a href="validator_set.html#sui_system_validator_set_pool_exchange_rates" class="hash-link" aria-label="Direct link to sui_system_validator_set_pool_exchange_rates" title="Direct link to sui_system_validator_set_pool_exchange_rates">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_pool_exchange_rates">pool_exchange_rates</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, pool_id: &amp;<a href="../sui-framework/object.html#sui_object_ID">sui::object::ID</a>): &amp;<a href="../sui/table.html#sui_table_Table">sui::table::Table</a>&lt;u64, <a href="staking_pool.html#sui_system_staking_pool_PoolTokenExchangeRate">sui_system::staking_pool::PoolTokenExchangeRate</a>&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_pool_exchange_rates">pool_exchange_rates</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    pool_id: &amp;ID,
): &amp;Table&lt;u64, PoolTokenExchangeRate&gt; {
    // If the pool id is recorded in the mapping, then it must be either candidate or active.
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <b>if</b> (self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>.contains(*pool_id)) {
        <b>let</b> validator_address = self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>[*pool_id];
        self.<a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref">get_active_or_pending_or_candidate_validator_ref</a>(validator_address, <a href="validator_set.html#sui_system_validator_set_ANY_VALIDATOR">ANY_VALIDATOR</a>)
    } <b>else</b> {
        // otherwise it&#x27;s inactive
        self.inactive_validators[*pool_id].load_validator_maybe_upgrade()
    };
    <a href="validator.html#sui_system_validator">validator</a>.get_staking_pool_ref().exchange_rates()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_next_epoch_validator_count">Function <code>next_epoch_validator_count</code><a href="validator_set.html#sui_system_validator_set_next_epoch_validator_count" class="hash-link" aria-label="Direct link to sui_system_validator_set_next_epoch_validator_count" title="Direct link to sui_system_validator_set_next_epoch_validator_count">​</a></h2>
<p>Get the total number of validators in the next epoch.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_next_epoch_validator_count">next_epoch_validator_count</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_next_epoch_validator_count">next_epoch_validator_count</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>): u64 {
    self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>.length() - self.pending_removals.length() + self.pending_active_validators.length()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_is_active_validator_by_sui_address">Function <code>is_active_validator_by_sui_address</code><a href="validator_set.html#sui_system_validator_set_is_active_validator_by_sui_address" class="hash-link" aria-label="Direct link to sui_system_validator_set_is_active_validator_by_sui_address" title="Direct link to sui_system_validator_set_is_active_validator_by_sui_address">​</a></h2>
<p>Returns true iff the address exists in active validators.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_active_validator_by_sui_address">is_active_validator_by_sui_address</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_address: <b>address</b>): bool
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_active_validator_by_sui_address">is_active_validator_by_sui_address</a>(
    self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    validator_address: <b>address</b>,
): bool {
    <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, validator_address).is_some()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_is_duplicate_with_active_validator">Function <code>is_duplicate_with_active_validator</code><a href="validator_set.html#sui_system_validator_set_is_duplicate_with_active_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_is_duplicate_with_active_validator" title="Direct link to sui_system_validator_set_is_duplicate_with_active_validator">​</a></h2>
<p>Checks whether new_validator is duplicate with any currently active validators.
It differs from <a href="validator_set.html#sui_system_validator_set_is_active_validator_by_sui_address">is_active_validator_by_sui_address</a> in that the former checks
only the sui address but this function looks at more metadata.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_duplicate_with_active_validator">is_duplicate_with_active_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, new_validator: &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>): bool
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_duplicate_with_active_validator">is_duplicate_with_active_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, new_validator: &amp;Validator): bool {
    <a href="validator_set.html#sui_system_validator_set_is_duplicate_validator">is_duplicate_validator</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, new_validator)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_is_duplicate_validator">Function <code>is_duplicate_validator</code><a href="validator_set.html#sui_system_validator_set_is_duplicate_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_is_duplicate_validator" title="Direct link to sui_system_validator_set_is_duplicate_validator">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_duplicate_validator">is_duplicate_validator</a>(validators: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, new_validator: &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>): bool
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_duplicate_validator">is_duplicate_validator</a>(
    validators: &amp;vector&lt;Validator&gt;,
    new_validator: &amp;Validator,
): bool {
    <a href="validator_set.html#sui_system_validator_set_count_duplicates_vec">count_duplicates_vec</a>(validators, new_validator) &gt; 0
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_count_duplicates_vec">Function <code>count_duplicates_vec</code><a href="validator_set.html#sui_system_validator_set_count_duplicates_vec" class="hash-link" aria-label="Direct link to sui_system_validator_set_count_duplicates_vec" title="Direct link to sui_system_validator_set_count_duplicates_vec">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_count_duplicates_vec">count_duplicates_vec</a>(validators: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, <a href="validator.html#sui_system_validator">validator</a>: &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_count_duplicates_vec">count_duplicates_vec</a>(validators: &amp;vector&lt;Validator&gt;, <a href="validator.html#sui_system_validator">validator</a>: &amp;Validator): u64 {
    validators.count!(|v| v.is_duplicate(<a href="validator.html#sui_system_validator">validator</a>))
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_is_duplicate_with_pending_validator">Function <code>is_duplicate_with_pending_validator</code><a href="validator_set.html#sui_system_validator_set_is_duplicate_with_pending_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_is_duplicate_with_pending_validator" title="Direct link to sui_system_validator_set_is_duplicate_with_pending_validator">​</a></h2>
<p>Checks whether new_validator is duplicate with any currently pending validators.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_duplicate_with_pending_validator">is_duplicate_with_pending_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, new_validator: &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>): bool
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_duplicate_with_pending_validator">is_duplicate_with_pending_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, new_validator: &amp;Validator): bool {
    <a href="validator_set.html#sui_system_validator_set_count_duplicates_tablevec">count_duplicates_tablevec</a>(&amp;self.pending_active_validators, new_validator) &gt; 0
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_count_duplicates_tablevec">Function <code>count_duplicates_tablevec</code><a href="validator_set.html#sui_system_validator_set_count_duplicates_tablevec" class="hash-link" aria-label="Direct link to sui_system_validator_set_count_duplicates_tablevec" title="Direct link to sui_system_validator_set_count_duplicates_tablevec">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_count_duplicates_tablevec">count_duplicates_tablevec</a>(validators: &amp;<a href="../sui/table_vec.html#sui_table_vec_TableVec">sui::table_vec::TableVec</a>&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, <a href="validator.html#sui_system_validator">validator</a>: &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_count_duplicates_tablevec">count_duplicates_tablevec</a>(validators: &amp;TableVec&lt;Validator&gt;, <a href="validator.html#sui_system_validator">validator</a>: &amp;Validator): u64 {
    <b>let</b> <b>mut</b> result = 0;
    validators.length().do!(|i| {
        <b>if</b> (validators[i].is_duplicate(<a href="validator.html#sui_system_validator">validator</a>)) {
            result = result + 1;
        };
    });
    result
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_candidate_or_active_validator_mut">Function <code>get_candidate_or_active_validator_mut</code><a href="validator_set.html#sui_system_validator_set_get_candidate_or_active_validator_mut" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_candidate_or_active_validator_mut" title="Direct link to sui_system_validator_set_get_candidate_or_active_validator_mut">​</a></h2>
<p>Get mutable reference to either a candidate or an active validator by address.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_candidate_or_active_validator_mut">get_candidate_or_active_validator_mut</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_address: <b>address</b>): &amp;<b>mut</b> <a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_candidate_or_active_validator_mut">get_candidate_or_active_validator_mut</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    validator_address: <b>address</b>,
): &amp;<b>mut</b> Validator {
    <b>if</b> (self.validator_candidates.contains(validator_address)) {
        self.validator_candidates[validator_address].load_validator_maybe_upgrade()
    } <b>else</b> {
        <a href="validator_set.html#sui_system_validator_set_get_validator_mut">get_validator_mut</a>(&amp;<b>mut</b> self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, validator_address)
    }
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_find_validator">Function <code>find_validator</code><a href="validator_set.html#sui_system_validator_set_find_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_find_validator" title="Direct link to sui_system_validator_set_find_validator">​</a></h2>
<p>Find validator by validator_address, in validators.
Returns (true, index) if the validator is found, and the index is its index in the list.
If not found, returns (false, 0).</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(validators: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, validator_address: <b>address</b>): <a href="../std/option.html#std_option_Option">std::option::Option</a>&lt;u64&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(validators: &amp;vector&lt;Validator&gt;, validator_address: <b>address</b>): Option&lt;u64&gt; {
    validators.find_index!(|v| v.sui_address() == validator_address)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_find_validator_from_table_vec">Function <code>find_validator_from_table_vec</code><a href="validator_set.html#sui_system_validator_set_find_validator_from_table_vec" class="hash-link" aria-label="Direct link to sui_system_validator_set_find_validator_from_table_vec" title="Direct link to sui_system_validator_set_find_validator_from_table_vec">​</a></h2>
<p>Find validator by validator_address, in validators.
Returns (true, index) if the validator is found, and the index is its index in the list.
If not found, returns (false, 0).</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_find_validator_from_table_vec">find_validator_from_table_vec</a>(validators: &amp;<a href="../sui/table_vec.html#sui_table_vec_TableVec">sui::table_vec::TableVec</a>&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, validator_address: <b>address</b>): <a href="../std/option.html#std_option_Option">std::option::Option</a>&lt;u64&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_find_validator_from_table_vec">find_validator_from_table_vec</a>(
    validators: &amp;TableVec&lt;Validator&gt;,
    validator_address: <b>address</b>,
): Option&lt;u64&gt; {
    <b>let</b> length = validators.length();
    <b>let</b> <b>mut</b> i = 0;
    <b>while</b> (i &lt; length) {
        <b>let</b> v = &amp;validators[i];
        <b>if</b> (v.sui_address() == validator_address) {
            <b>return</b> option::some(i)
        };
        i = i + 1;
    };
    option::none()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_validator_indices">Function <code>get_validator_indices</code><a href="validator_set.html#sui_system_validator_set_get_validator_indices" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_validator_indices" title="Direct link to sui_system_validator_set_get_validator_indices">​</a></h2>
<p>Given a vector of validator addresses, return their indices in the validator set.
Aborts if any address isn&#x27;t in the given validator set.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_indices">get_validator_indices</a>(validators: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, validator_addresses: &amp;vector&lt;<b>address</b>&gt;): vector&lt;u64&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_indices">get_validator_indices</a>(
    validators: &amp;vector&lt;Validator&gt;,
    validator_addresses: &amp;vector&lt;<b>address</b>&gt;,
): vector&lt;u64&gt; {
    <b>let</b> <b>mut</b> res = vector[];
    validator_addresses.do_ref!(|addr| {
        <b>let</b> idx = <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(validators, *addr).destroy_or!(<b>abort</b> <a href="validator_set.html#sui_system_validator_set_ENotAValidator">ENotAValidator</a>);
        res.push_back(idx);
    });
    res
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_validator_mut">Function <code>get_validator_mut</code><a href="validator_set.html#sui_system_validator_set_get_validator_mut" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_validator_mut" title="Direct link to sui_system_validator_set_get_validator_mut">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_mut">get_validator_mut</a>(validators: &amp;<b>mut</b> vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, validator_address: <b>address</b>): &amp;<b>mut</b> <a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_mut">get_validator_mut</a>(
    validators: &amp;<b>mut</b> vector&lt;Validator&gt;,
    validator_address: <b>address</b>,
): &amp;<b>mut</b> Validator {
    <b>let</b> idx = <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(validators, validator_address).destroy_or!(<b>abort</b> <a href="validator_set.html#sui_system_validator_set_ENotAValidator">ENotAValidator</a>);
    &amp;<b>mut</b> validators[idx]
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut">Function <code>get_active_or_pending_or_candidate_validator_mut</code><a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut" title="Direct link to sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut">​</a></h2>
<p>Get mutable reference to an active or (if active does not exist) pending or (if pending and
active do not exist) or candidate validator by address.
Note: this function should be called carefully, only after verifying the transaction
sender has the ability to modify the Validator.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut">get_active_or_pending_or_candidate_validator_mut</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_address: <b>address</b>, include_candidate: bool): &amp;<b>mut</b> <a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut">get_active_or_pending_or_candidate_validator_mut</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    validator_address: <b>address</b>,
    include_candidate: bool,
): &amp;<b>mut</b> Validator {
    <b>let</b> <b>mut</b> validator_index_opt = <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, validator_address);
    <b>if</b> (validator_index_opt.is_some()) {
        <b>let</b> validator_index = validator_index_opt.extract();
        <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = &amp;<b>mut</b> self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>[validator_index];
        <b>return</b> <a href="validator.html#sui_system_validator">validator</a>
    };
    <b>let</b> <b>mut</b> validator_index_opt = <a href="validator_set.html#sui_system_validator_set_find_validator_from_table_vec">find_validator_from_table_vec</a>(
        &amp;self.pending_active_validators,
        validator_address,
    );
    // consider both pending validators and the candidate ones
    <b>if</b> (validator_index_opt.is_some()) {
        <b>let</b> validator_index = validator_index_opt.extract();
        <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = &amp;<b>mut</b> self.pending_active_validators[validator_index];
        <b>return</b> <a href="validator.html#sui_system_validator">validator</a>
    };
    <b>assert</b>!(include_candidate, <a href="validator_set.html#sui_system_validator_set_ENotActiveOrPendingValidator">ENotActiveOrPendingValidator</a>);
    self.validator_candidates[validator_address].load_validator_maybe_upgrade()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_validator_mut_with_verified_cap">Function <code>get_validator_mut_with_verified_cap</code><a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_verified_cap" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_validator_mut_with_verified_cap" title="Direct link to sui_system_validator_set_get_validator_mut_with_verified_cap">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_verified_cap">get_validator_mut_with_verified_cap</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, verified_cap: &amp;<a href="validator_cap.html#sui_system_validator_cap_ValidatorOperationCap">sui_system::validator_cap::ValidatorOperationCap</a>, include_candidate: bool): &amp;<b>mut</b> <a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_verified_cap">get_validator_mut_with_verified_cap</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    verified_cap: &amp;ValidatorOperationCap,
    include_candidate: bool,
): &amp;<b>mut</b> Validator {
    self.<a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut">get_active_or_pending_or_candidate_validator_mut</a>(
        *verified_cap.verified_operation_cap_address(),
        include_candidate,
    )
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_validator_mut_with_ctx">Function <code>get_validator_mut_with_ctx</code><a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_validator_mut_with_ctx" title="Direct link to sui_system_validator_set_get_validator_mut_with_ctx">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx">get_validator_mut_with_ctx</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): &amp;<b>mut</b> <a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx">get_validator_mut_with_ctx</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    ctx: &amp;TxContext,
): &amp;<b>mut</b> Validator {
    <b>let</b> validator_address = ctx.sender();
    self.<a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut">get_active_or_pending_or_candidate_validator_mut</a>(validator_address, <b>false</b>)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_validator_mut_with_ctx_including_candidates">Function <code>get_validator_mut_with_ctx_including_candidates</code><a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx_including_candidates" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_validator_mut_with_ctx_including_candidates" title="Direct link to sui_system_validator_set_get_validator_mut_with_ctx_including_candidates">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx_including_candidates">get_validator_mut_with_ctx_including_candidates</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): &amp;<b>mut</b> <a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx_including_candidates">get_validator_mut_with_ctx_including_candidates</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    ctx: &amp;TxContext,
): &amp;<b>mut</b> Validator {
    <b>let</b> validator_address = ctx.sender();
    self.<a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut">get_active_or_pending_or_candidate_validator_mut</a>(validator_address, <b>true</b>)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_validator_ref">Function <code>get_validator_ref</code><a href="validator_set.html#sui_system_validator_set_get_validator_ref" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_validator_ref" title="Direct link to sui_system_validator_set_get_validator_ref">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_ref">get_validator_ref</a>(validators: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, validator_address: <b>address</b>): &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_validator_ref">get_validator_ref</a>(validators: &amp;vector&lt;Validator&gt;, validator_address: <b>address</b>): &amp;Validator {
    <b>let</b> idx = <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(validators, validator_address).destroy_or!(<b>abort</b> <a href="validator_set.html#sui_system_validator_set_ENotAValidator">ENotAValidator</a>);
    &amp;validators[idx]
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref">Function <code>get_active_or_pending_or_candidate_validator_ref</code><a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref" title="Direct link to sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref">get_active_or_pending_or_candidate_validator_ref</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_address: <b>address</b>, which_validator: u8): &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref">get_active_or_pending_or_candidate_validator_ref</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    validator_address: <b>address</b>,
    which_validator: u8,
): &amp;Validator {
    <b>let</b> <b>mut</b> validator_index_opt = <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, validator_address);
    <b>if</b> (validator_index_opt.is_some() || which_validator == <a href="validator_set.html#sui_system_validator_set_ACTIVE_VALIDATOR_ONLY">ACTIVE_VALIDATOR_ONLY</a>) {
        <b>let</b> validator_index = validator_index_opt.extract();
        <b>return</b> &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>[validator_index]
    };
    <b>let</b> <b>mut</b> validator_index_opt = <a href="validator_set.html#sui_system_validator_set_find_validator_from_table_vec">find_validator_from_table_vec</a>(
        &amp;self.pending_active_validators,
        validator_address,
    );
    <b>if</b> (validator_index_opt.is_some() || which_validator == <a href="validator_set.html#sui_system_validator_set_ACTIVE_OR_PENDING_VALIDATOR">ACTIVE_OR_PENDING_VALIDATOR</a>) {
        <b>let</b> validator_index = validator_index_opt.extract();
        <b>return</b> &amp;self.pending_active_validators[validator_index]
    };
    self.validator_candidates[validator_address].load_validator_maybe_upgrade()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_active_validator_ref">Function <code>get_active_validator_ref</code><a href="validator_set.html#sui_system_validator_set_get_active_validator_ref" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_active_validator_ref" title="Direct link to sui_system_validator_set_get_active_validator_ref">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_active_validator_ref">get_active_validator_ref</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, addr: <b>address</b>): &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_active_validator_ref">get_active_validator_ref</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, addr: <b>address</b>): &amp;Validator {
    <b>let</b> idx = <a href="validator_set.html#sui_system_validator_set_find_validator">find_validator</a>(&amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>, addr).destroy_or!(<b>abort</b> <a href="validator_set.html#sui_system_validator_set_ENotAValidator">ENotAValidator</a>);
    &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>[idx]
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_get_pending_validator_ref">Function <code>get_pending_validator_ref</code><a href="validator_set.html#sui_system_validator_set_get_pending_validator_ref" class="hash-link" aria-label="Direct link to sui_system_validator_set_get_pending_validator_ref" title="Direct link to sui_system_validator_set_get_pending_validator_ref">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_pending_validator_ref">get_pending_validator_ref</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, addr: <b>address</b>): &amp;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_get_pending_validator_ref">get_pending_validator_ref</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, addr: <b>address</b>): &amp;Validator {
    <b>let</b> idx = <a href="validator_set.html#sui_system_validator_set_find_validator_from_table_vec">find_validator_from_table_vec</a>(
        &amp;self.pending_active_validators,
        addr,
    ).destroy_or!(<b>abort</b> <a href="validator_set.html#sui_system_validator_set_ENotAPendingValidator">ENotAPendingValidator</a>);
    &amp;self.pending_active_validators[idx]
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_verify_cap">Function <code>verify_cap</code><a href="validator_set.html#sui_system_validator_set_verify_cap" class="hash-link" aria-label="Direct link to sui_system_validator_set_verify_cap" title="Direct link to sui_system_validator_set_verify_cap">​</a></h2>
<p>Verify the capability is valid for a Validator.
If active_validator_only is true, only verify the Cap for an active validator.
Otherwise, verify the Cap for au either active or pending validator.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_verify_cap">verify_cap</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, cap: &amp;<a href="validator_cap.html#sui_system_validator_cap_UnverifiedValidatorOperationCap">sui_system::validator_cap::UnverifiedValidatorOperationCap</a>, which_validator: u8): <a href="validator_cap.html#sui_system_validator_cap_ValidatorOperationCap">sui_system::validator_cap::ValidatorOperationCap</a>
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_verify_cap">verify_cap</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    cap: &amp;UnverifiedValidatorOperationCap,
    which_validator: u8,
): ValidatorOperationCap {
    <b>let</b> cap_address = *cap.unverified_operation_cap_address();
    <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <b>if</b> (which_validator == <a href="validator_set.html#sui_system_validator_set_ACTIVE_VALIDATOR_ONLY">ACTIVE_VALIDATOR_ONLY</a>) {
        self.<a href="validator_set.html#sui_system_validator_set_get_active_validator_ref">get_active_validator_ref</a>(cap_address)
    } <b>else</b> {
        self.<a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref">get_active_or_pending_or_candidate_validator_ref</a>(cap_address, which_validator)
    };
    <b>assert</b>!(<a href="validator.html#sui_system_validator">validator</a>.operation_cap_id() == &amp;object::id(cap), <a href="validator_set.html#sui_system_validator_set_EInvalidCap">EInvalidCap</a>);
    cap.into_verified()
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_process_pending_removals">Function <code>process_pending_removals</code><a href="validator_set.html#sui_system_validator_set_process_pending_removals" class="hash-link" aria-label="Direct link to sui_system_validator_set_process_pending_removals" title="Direct link to sui_system_validator_set_process_pending_removals">​</a></h2>
<p>Process the pending withdraw requests. For each pending request, the validator
is removed from validators and its staking pool is put into the inactive_validators table.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_process_pending_removals">process_pending_removals</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_report_records: &amp;<b>mut</b> <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;<b>address</b>, <a href="../sui/vec_set.html#sui_vec_set_VecSet">sui::vec_set::VecSet</a>&lt;<b>address</b>&gt;&gt;, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_process_pending_removals">process_pending_removals</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    validator_report_records: &amp;<b>mut</b> VecMap&lt;<b>address</b>, VecSet&lt;<b>address</b>&gt;&gt;,
    ctx: &amp;<b>mut</b> TxContext,
) {
    <a href="validator_set.html#sui_system_validator_set_sort_removal_list">sort_removal_list</a>(&amp;<b>mut</b> self.pending_removals);
    self.pending_removals.length().do!(|_| {
        <b>let</b> index = self.pending_removals.pop_back();
        <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>.remove(index);
        self.<a href="validator_set.html#sui_system_validator_set_process_validator_departure">process_validator_departure</a>(
            <a href="validator.html#sui_system_validator">validator</a>,
            validator_report_records,
            <b>true</b>, // the <a href="validator.html#sui_system_validator">validator</a> removes itself voluntarily
            ctx,
        );
    });
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_process_validator_departure">Function <code>process_validator_departure</code><a href="validator_set.html#sui_system_validator_set_process_validator_departure" class="hash-link" aria-label="Direct link to sui_system_validator_set_process_validator_departure" title="Direct link to sui_system_validator_set_process_validator_departure">​</a></h2>
<p>Remove <a href="validator.html#sui_system_validator">validator</a> from self and return the amount of stake that was removed</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_process_validator_departure">process_validator_departure</a>(self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, <a href="validator.html#sui_system_validator">validator</a>: <a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>, validator_report_records: &amp;<b>mut</b> <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;<b>address</b>, <a href="../sui/vec_set.html#sui_vec_set_VecSet">sui::vec_set::VecSet</a>&lt;<b>address</b>&gt;&gt;, is_voluntary: bool, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_process_validator_departure">process_validator_departure</a>(
    self: &amp;<b>mut</b> <a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    <b>mut</b> <a href="validator.html#sui_system_validator">validator</a>: Validator,
    validator_report_records: &amp;<b>mut</b> VecMap&lt;<b>address</b>, VecSet&lt;<b>address</b>&gt;&gt;,
    is_voluntary: bool,
    ctx: &amp;<b>mut</b> TxContext,
): u64 {
    <b>let</b> new_epoch = ctx.epoch() + 1;
    <b>let</b> validator_address = <a href="validator.html#sui_system_validator">validator</a>.sui_address();
    <b>let</b> validator_pool_id = <a href="validator.html#sui_system_validator">validator</a>.staking_pool_id();
    // Remove the <a href="validator.html#sui_system_validator">validator</a> from our tables.
    self.<a href="validator_set.html#sui_system_validator_set_staking_pool_mappings">staking_pool_mappings</a>.remove(validator_pool_id);
    <b>if</b> (self.at_risk_validators.contains(&amp;validator_address)) {
        self.at_risk_validators.remove(&amp;validator_address);
    };
    <a href="validator_set.html#sui_system_validator_set_clean_report_records_leaving_validator">clean_report_records_leaving_validator</a>(validator_report_records, validator_address);
    event::emit(<a href="validator_set.html#sui_system_validator_set_ValidatorLeaveEvent">ValidatorLeaveEvent</a> {
        epoch: new_epoch,
        validator_address,
        staking_pool_id: <a href="validator.html#sui_system_validator">validator</a>.staking_pool_id(),
        is_voluntary,
    });
    // Deactivate the <a href="validator.html#sui_system_validator">validator</a> and its staking pool
    <b>let</b> removed_stake = <a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>();
    <a href="validator.html#sui_system_validator">validator</a>.deactivate(new_epoch);
    self
        .inactive_validators
        .add(
            validator_pool_id,
            <a href="validator.html#sui_system_validator">validator</a>.wrap_v1(ctx),
        );
    removed_stake
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_clean_report_records_leaving_validator">Function <code>clean_report_records_leaving_validator</code><a href="validator_set.html#sui_system_validator_set_clean_report_records_leaving_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_clean_report_records_leaving_validator" title="Direct link to sui_system_validator_set_clean_report_records_leaving_validator">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_clean_report_records_leaving_validator">clean_report_records_leaving_validator</a>(validator_report_records: &amp;<b>mut</b> <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;<b>address</b>, <a href="../sui/vec_set.html#sui_vec_set_VecSet">sui::vec_set::VecSet</a>&lt;<b>address</b>&gt;&gt;, leaving_validator_addr: <b>address</b>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_clean_report_records_leaving_validator">clean_report_records_leaving_validator</a>(
    validator_report_records: &amp;<b>mut</b> VecMap&lt;<b>address</b>, VecSet&lt;<b>address</b>&gt;&gt;,
    leaving_validator_addr: <b>address</b>,
) {
    // Remove the records about this <a href="validator.html#sui_system_validator">validator</a>
    <b>if</b> (validator_report_records.contains(&amp;leaving_validator_addr)) {
        validator_report_records.remove(&amp;leaving_validator_addr);
    };
    // Remove the reports submitted by this <a href="validator.html#sui_system_validator">validator</a>
    <b>let</b> reported_validators = validator_report_records.keys();
    reported_validators.length().do!(|i| {
        <b>let</b> reported_validator_addr = &amp;reported_validators[i];
        <b>let</b> reporters = &amp;<b>mut</b> validator_report_records[reported_validator_addr];
        <b>if</b> (reporters.contains(&amp;leaving_validator_addr)) {
            reporters.remove(&amp;leaving_validator_addr);
            <b>if</b> (reporters.is_empty()) {
                validator_report_records.remove(reported_validator_addr);
            };
        };
    });
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_sort_removal_list">Function <code>sort_removal_list</code><a href="validator_set.html#sui_system_validator_set_sort_removal_list" class="hash-link" aria-label="Direct link to sui_system_validator_set_sort_removal_list" title="Direct link to sui_system_validator_set_sort_removal_list">​</a></h2>
<p>Sort all the pending removal indexes.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_sort_removal_list">sort_removal_list</a>(withdraw_list: &amp;<b>mut</b> vector&lt;u64&gt;)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_sort_removal_list">sort_removal_list</a>(withdraw_list: &amp;<b>mut</b> vector&lt;u64&gt;) {
    <b>let</b> length = withdraw_list.length();
    <b>let</b> <b>mut</b> i = 1;
    <b>while</b> (i &lt; length) {
        <b>let</b> cur = withdraw_list[i];
        <b>let</b> <b>mut</b> j = i;
        <b>while</b> (j &gt; 0) {
            j = j - 1;
            <b>if</b> (withdraw_list[j] &gt; cur) {
                withdraw_list.swap(j, j + 1);
            } <b>else</b> {
                <b>break</b>
            };
        };
        i = i + 1;
    };
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_process_pending_stakes_and_withdraws">Function <code>process_pending_stakes_and_withdraws</code><a href="validator_set.html#sui_system_validator_set_process_pending_stakes_and_withdraws" class="hash-link" aria-label="Direct link to sui_system_validator_set_process_pending_stakes_and_withdraws" title="Direct link to sui_system_validator_set_process_pending_stakes_and_withdraws">​</a></h2>
<p>Process all active validators&#x27; pending stake deposits and withdraws.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_process_pending_stakes_and_withdraws">process_pending_stakes_and_withdraws</a>(validators: &amp;<b>mut</b> vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, ctx: &amp;<a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_process_pending_stakes_and_withdraws">process_pending_stakes_and_withdraws</a>(validators: &amp;<b>mut</b> vector&lt;Validator&gt;, ctx: &amp;TxContext) {
    validators.do_mut!(|v| v.<a href="validator_set.html#sui_system_validator_set_process_pending_stakes_and_withdraws">process_pending_stakes_and_withdraws</a>(ctx))
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_calculate_total_stakes">Function <code>calculate_total_stakes</code><a href="validator_set.html#sui_system_validator_set_calculate_total_stakes" class="hash-link" aria-label="Direct link to sui_system_validator_set_calculate_total_stakes" title="Direct link to sui_system_validator_set_calculate_total_stakes">​</a></h2>
<p>Calculate the total active validator stake.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_calculate_total_stakes">calculate_total_stakes</a>(validators: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_calculate_total_stakes">calculate_total_stakes</a>(validators: &amp;vector&lt;Validator&gt;): u64 {
    <b>let</b> <b>mut</b> stake = 0;
    validators.do_ref!(|v| stake = stake + v.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>());
    stake
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_adjust_stake_and_gas_price">Function <code>adjust_stake_and_gas_price</code><a href="validator_set.html#sui_system_validator_set_adjust_stake_and_gas_price" class="hash-link" aria-label="Direct link to sui_system_validator_set_adjust_stake_and_gas_price" title="Direct link to sui_system_validator_set_adjust_stake_and_gas_price">​</a></h2>
<p>Process the pending stake changes for each validator.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_adjust_stake_and_gas_price">adjust_stake_and_gas_price</a>(validators: &amp;<b>mut</b> vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_adjust_stake_and_gas_price">adjust_stake_and_gas_price</a>(validators: &amp;<b>mut</b> vector&lt;Validator&gt;) {
    validators.do_mut!(|v| v.<a href="validator_set.html#sui_system_validator_set_adjust_stake_and_gas_price">adjust_stake_and_gas_price</a>())
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_compute_reward_adjustments">Function <code>compute_reward_adjustments</code><a href="validator_set.html#sui_system_validator_set_compute_reward_adjustments" class="hash-link" aria-label="Direct link to sui_system_validator_set_compute_reward_adjustments" title="Direct link to sui_system_validator_set_compute_reward_adjustments">​</a></h2>
<p>Compute both the individual reward adjustments and total reward adjustment for staking rewards
as well as storage fund rewards.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_compute_reward_adjustments">compute_reward_adjustments</a>(slashed_validator_indices: vector&lt;u64&gt;, reward_slashing_rate: u64, unadjusted_staking_reward_amounts: &amp;vector&lt;u64&gt;, unadjusted_storage_fund_reward_amounts: &amp;vector&lt;u64&gt;): (u64, <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;u64, u64&gt;, u64, <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;u64, u64&gt;)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_compute_reward_adjustments">compute_reward_adjustments</a>(
    slashed_validator_indices: vector&lt;u64&gt;,
    reward_slashing_rate: u64,
    unadjusted_staking_reward_amounts: &amp;vector&lt;u64&gt;,
    unadjusted_storage_fund_reward_amounts: &amp;vector&lt;u64&gt;,
): (
    u64, // sum of staking reward adjustments
    VecMap&lt;u64, u64&gt;, // mapping of individual <a href="validator.html#sui_system_validator">validator</a>&#x27;s staking reward adjustment from index -&gt; amount
    u64, // sum of storage fund reward adjustments
    VecMap&lt;u64, u64&gt;, // mapping of individual <a href="validator.html#sui_system_validator">validator</a>&#x27;s storage fund reward adjustment from index -&gt; amount
) {
    <b>let</b> <b>mut</b> total_staking_reward_adjustment = 0;
    <b>let</b> <b>mut</b> individual_staking_reward_adjustments = vec_map::empty();
    <b>let</b> <b>mut</b> total_storage_fund_reward_adjustment = 0;
    <b>let</b> <b>mut</b> individual_storage_fund_reward_adjustments = vec_map::empty();
    slashed_validator_indices.destroy!(|validator_index| {
        // Use the slashing rate to compute the amount of staking rewards slashed from this punished <a href="validator.html#sui_system_validator">validator</a>.
        <b>let</b> unadjusted_staking_reward = unadjusted_staking_reward_amounts[validator_index];
        <b>let</b> staking_reward_adjustment = <a href="validator_set.html#sui_system_validator_set_mul_div">mul_div</a>!(
            unadjusted_staking_reward,
            reward_slashing_rate,
            <a href="validator_set.html#sui_system_validator_set_BASIS_POINT_DENOMINATOR">BASIS_POINT_DENOMINATOR</a>,
        );
        // Insert into individual mapping and record into the total adjustment sum.
        individual_staking_reward_adjustments.insert(validator_index, staking_reward_adjustment);
        total_staking_reward_adjustment =
            total_staking_reward_adjustment + staking_reward_adjustment;
        // Do the same thing <b>for</b> storage fund rewards.
        <b>let</b> unadjusted_storage_fund_reward = unadjusted_storage_fund_reward_amounts[
            validator_index,
        ];
        <b>let</b> storage_fund_reward_adjustment = <a href="validator_set.html#sui_system_validator_set_mul_div">mul_div</a>!(
            unadjusted_storage_fund_reward,
            reward_slashing_rate,
            <a href="validator_set.html#sui_system_validator_set_BASIS_POINT_DENOMINATOR">BASIS_POINT_DENOMINATOR</a>,
        );
        individual_storage_fund_reward_adjustments.insert(
            validator_index,
            storage_fund_reward_adjustment,
        );
        total_storage_fund_reward_adjustment =
            total_storage_fund_reward_adjustment + storage_fund_reward_adjustment;
    });
    (
        total_staking_reward_adjustment,
        individual_staking_reward_adjustments,
        total_storage_fund_reward_adjustment,
        individual_storage_fund_reward_adjustments,
    )
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_compute_slashed_validators">Function <code>compute_slashed_validators</code><a href="validator_set.html#sui_system_validator_set_compute_slashed_validators" class="hash-link" aria-label="Direct link to sui_system_validator_set_compute_slashed_validators" title="Direct link to sui_system_validator_set_compute_slashed_validators">​</a></h2>
<p>Process the validator report records of the epoch and return the addresses of the
non-performant validators according to the input threshold.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_compute_slashed_validators">compute_slashed_validators</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, validator_report_records: <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;<b>address</b>, <a href="../sui/vec_set.html#sui_vec_set_VecSet">sui::vec_set::VecSet</a>&lt;<b>address</b>&gt;&gt;): vector&lt;<b>address</b>&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_compute_slashed_validators">compute_slashed_validators</a>(
    self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>,
    <b>mut</b> validator_report_records: VecMap&lt;<b>address</b>, VecSet&lt;<b>address</b>&gt;&gt;,
): vector&lt;<b>address</b>&gt; {
    <b>let</b> <b>mut</b> slashed_validators = vector[];
    <b>while</b> (!validator_report_records.is_empty()) {
        <b>let</b> (validator_address, reporters) = validator_report_records.pop();
        <b>assert</b>!(
            self.<a href="validator_set.html#sui_system_validator_set_is_active_validator_by_sui_address">is_active_validator_by_sui_address</a>(validator_address),
            <a href="validator_set.html#sui_system_validator_set_ENonValidatorInReportRecords">ENonValidatorInReportRecords</a>,
        );
        // Sum up the voting power of validators that have reported this <a href="validator.html#sui_system_validator">validator</a> and check <b>if</b> it <b>has</b>
        // passed the slashing threshold.
        <b>let</b> reporter_votes = <a href="validator_set.html#sui_system_validator_set_sum_voting_power_by_addresses">sum_voting_power_by_addresses</a>(
            &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>,
            &amp;reporters.into_keys(),
        );
        <b>if</b> (reporter_votes &gt;= <a href="voting_power.html#sui_system_voting_power_quorum_threshold">voting_power::quorum_threshold</a>()) {
            slashed_validators.push_back(validator_address);
        }
    };
    slashed_validators
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_compute_unadjusted_reward_distribution">Function <code>compute_unadjusted_reward_distribution</code><a href="validator_set.html#sui_system_validator_set_compute_unadjusted_reward_distribution" class="hash-link" aria-label="Direct link to sui_system_validator_set_compute_unadjusted_reward_distribution" title="Direct link to sui_system_validator_set_compute_unadjusted_reward_distribution">​</a></h2>
<p>Given the current list of active validators, the total stake and total reward,
calculate the amount of reward each validator should get, without taking into
account the tallying rule results.
Returns the unadjusted amounts of staking reward and storage fund reward for each validator.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_compute_unadjusted_reward_distribution">compute_unadjusted_reward_distribution</a>(validators: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, total_voting_power: u64, total_staking_reward: u64, total_storage_fund_reward: u64): (vector&lt;u64&gt;, vector&lt;u64&gt;)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_compute_unadjusted_reward_distribution">compute_unadjusted_reward_distribution</a>(
    validators: &amp;vector&lt;Validator&gt;,
    total_voting_power: u64,
    total_staking_reward: u64,
    total_storage_fund_reward: u64,
): (vector&lt;u64&gt;, vector&lt;u64&gt;) {
    <b>let</b> <b>mut</b> staking_reward_amounts = vector[];
    <b>let</b> <b>mut</b> storage_fund_reward_amounts = vector[];
    <b>let</b> length = validators.length();
    <b>let</b> storage_fund_reward_per_validator = total_storage_fund_reward / length;
    validators.do_ref!(|<a href="validator.html#sui_system_validator">validator</a>| {
        // Integer divisions will truncate the results. Because of this, we expect that at the end
        // there will be some reward remaining in `total_staking_reward`.
        // Use u128 to avoid multiplication overflow.
        <b>let</b> <a href="voting_power.html#sui_system_voting_power">voting_power</a> = <a href="validator.html#sui_system_validator">validator</a>.<a href="voting_power.html#sui_system_voting_power">voting_power</a>();
        <b>let</b> reward_amount = <a href="validator_set.html#sui_system_validator_set_mul_div">mul_div</a>!(<a href="voting_power.html#sui_system_voting_power">voting_power</a>, total_staking_reward, total_voting_power);
        staking_reward_amounts.push_back(reward_amount);
        // Storage fund&#x27;s share of the rewards are equally distributed among validators.
        storage_fund_reward_amounts.push_back(storage_fund_reward_per_validator);
    });
    (staking_reward_amounts, storage_fund_reward_amounts)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_compute_adjusted_reward_distribution">Function <code>compute_adjusted_reward_distribution</code><a href="validator_set.html#sui_system_validator_set_compute_adjusted_reward_distribution" class="hash-link" aria-label="Direct link to sui_system_validator_set_compute_adjusted_reward_distribution" title="Direct link to sui_system_validator_set_compute_adjusted_reward_distribution">​</a></h2>
<p>Use the reward adjustment info to compute the adjusted rewards each validator should get.
Returns the staking rewards each validator gets and the storage fund rewards each validator gets.
The staking rewards are shared with the stakers while the storage fund ones are not.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_compute_adjusted_reward_distribution">compute_adjusted_reward_distribution</a>(validators: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, total_voting_power: u64, total_slashed_validator_voting_power: u64, unadjusted_staking_reward_amounts: vector&lt;u64&gt;, unadjusted_storage_fund_reward_amounts: vector&lt;u64&gt;, total_staking_reward_adjustment: u64, individual_staking_reward_adjustments: <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;u64, u64&gt;, total_storage_fund_reward_adjustment: u64, individual_storage_fund_reward_adjustments: <a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;u64, u64&gt;): (vector&lt;u64&gt;, vector&lt;u64&gt;)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_compute_adjusted_reward_distribution">compute_adjusted_reward_distribution</a>(
    validators: &amp;vector&lt;Validator&gt;,
    total_voting_power: u64,
    total_slashed_validator_voting_power: u64,
    unadjusted_staking_reward_amounts: vector&lt;u64&gt;,
    unadjusted_storage_fund_reward_amounts: vector&lt;u64&gt;,
    total_staking_reward_adjustment: u64,
    individual_staking_reward_adjustments: VecMap&lt;u64, u64&gt;,
    total_storage_fund_reward_adjustment: u64,
    individual_storage_fund_reward_adjustments: VecMap&lt;u64, u64&gt;,
): (vector&lt;u64&gt;, vector&lt;u64&gt;) {
    <b>let</b> total_unslashed_validator_voting_power =
        total_voting_power - total_slashed_validator_voting_power;
    <b>let</b> <b>mut</b> adjusted_staking_reward_amounts = vector[];
    <b>let</b> <b>mut</b> adjusted_storage_fund_reward_amounts = vector[];
    <b>let</b> length = validators.length();
    <b>let</b> num_unslashed_validators = length - individual_staking_reward_adjustments.size();
    length.do!(|i| {
        <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = &amp;validators[i];
        // Integer divisions will truncate the results. Because of this, we expect that at the end
        // there will be some reward remaining in `total_reward`.
        // Use u128 to avoid multiplication overflow.
        <b>let</b> <a href="voting_power.html#sui_system_voting_power">voting_power</a> = <a href="validator.html#sui_system_validator">validator</a>.<a href="voting_power.html#sui_system_voting_power">voting_power</a>();
        // Compute adjusted staking reward.
        <b>let</b> unadjusted_staking_reward_amount = unadjusted_staking_reward_amounts[i];
        // If the <a href="validator.html#sui_system_validator">validator</a> is one of the slashed ones, then subtract the adjustment.
        <b>let</b> adjusted_staking_reward_amount = <b>if</b> (
            individual_staking_reward_adjustments.contains(&amp;i)
        ) {
            <b>let</b> adjustment = individual_staking_reward_adjustments[&amp;i];
            unadjusted_staking_reward_amount - adjustment
        } <b>else</b> {
            // Otherwise the slashed rewards should be distributed among the unslashed
            // validators so add the corresponding adjustment.
            <b>let</b> adjustment = <a href="validator_set.html#sui_system_validator_set_mul_div">mul_div</a>!(
                total_staking_reward_adjustment,
                <a href="voting_power.html#sui_system_voting_power">voting_power</a>,
                total_unslashed_validator_voting_power,
            );
            unadjusted_staking_reward_amount + adjustment
        };
        adjusted_staking_reward_amounts.push_back(adjusted_staking_reward_amount);
        // Compute adjusted storage fund reward.
        <b>let</b> unadjusted_storage_fund_reward_amount = unadjusted_storage_fund_reward_amounts[i];
        // If the <a href="validator.html#sui_system_validator">validator</a> is one of the slashed ones, then subtract the adjustment.
        <b>let</b> adjusted_storage_fund_reward_amount = <b>if</b> (
            individual_storage_fund_reward_adjustments.contains(&amp;i)
        ) {
            <b>let</b> adjustment = individual_storage_fund_reward_adjustments[&amp;i];
            unadjusted_storage_fund_reward_amount - adjustment
        } <b>else</b> {
            // Otherwise the slashed rewards should be equally distributed among the unslashed validators.
            <b>let</b> adjustment = total_storage_fund_reward_adjustment / num_unslashed_validators;
            unadjusted_storage_fund_reward_amount + adjustment
        };
        adjusted_storage_fund_reward_amounts.push_back(adjusted_storage_fund_reward_amount);
    });
    (adjusted_staking_reward_amounts, adjusted_storage_fund_reward_amounts)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_distribute_reward">Function <code>distribute_reward</code><a href="validator_set.html#sui_system_validator_set_distribute_reward" class="hash-link" aria-label="Direct link to sui_system_validator_set_distribute_reward" title="Direct link to sui_system_validator_set_distribute_reward">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_distribute_reward">distribute_reward</a>(validators: &amp;<b>mut</b> vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, adjusted_staking_reward_amounts: &amp;vector&lt;u64&gt;, adjusted_storage_fund_reward_amounts: &amp;vector&lt;u64&gt;, staking_rewards: &amp;<b>mut</b> <a href="../sui/balance.html#sui_balance_Balance">sui::balance::Balance</a>&lt;<a href="../sui/sui.html#sui_sui_SUI">sui::sui::SUI</a>&gt;, storage_fund_reward: &amp;<b>mut</b> <a href="../sui/balance.html#sui_balance_Balance">sui::balance::Balance</a>&lt;<a href="../sui/sui.html#sui_sui_SUI">sui::sui::SUI</a>&gt;, ctx: &amp;<b>mut</b> <a href="../sui/tx_context.html#sui_tx_context_TxContext">sui::tx_context::TxContext</a>)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_distribute_reward">distribute_reward</a>(
    validators: &amp;<b>mut</b> vector&lt;Validator&gt;,
    adjusted_staking_reward_amounts: &amp;vector&lt;u64&gt;,
    adjusted_storage_fund_reward_amounts: &amp;vector&lt;u64&gt;,
    staking_rewards: &amp;<b>mut</b> Balance&lt;SUI&gt;,
    storage_fund_reward: &amp;<b>mut</b> Balance&lt;SUI&gt;,
    ctx: &amp;<b>mut</b> TxContext,
) {
    <b>let</b> length = validators.length();
    <b>assert</b>!(length &gt; 0, <a href="validator_set.html#sui_system_validator_set_EValidatorSetEmpty">EValidatorSetEmpty</a>);
    length.do!(|i| {
        <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = &amp;<b>mut</b> validators[i];
        <b>let</b> staking_reward_amount = adjusted_staking_reward_amounts[i];
        <b>let</b> <b>mut</b> staker_reward = staking_rewards.split(staking_reward_amount);
        // Validator takes a cut of the rewards <b>as</b> commission.
        <b>let</b> validator_commission_amount = <a href="validator_set.html#sui_system_validator_set_mul_div">mul_div</a>!(
            staking_reward_amount,
            <a href="validator.html#sui_system_validator">validator</a>.commission_rate(),
            <a href="validator_set.html#sui_system_validator_set_BASIS_POINT_DENOMINATOR">BASIS_POINT_DENOMINATOR</a>,
        );
        // The <a href="validator.html#sui_system_validator">validator</a> reward = storage_fund_reward + commission.
        <b>let</b> <b>mut</b> validator_reward = staker_reward.split(validator_commission_amount <b>as</b> u64);
        // Add storage fund rewards to the <a href="validator.html#sui_system_validator">validator</a>&#x27;s reward.
        validator_reward.join(storage_fund_reward.split(adjusted_storage_fund_reward_amounts[i]));
        // Add rewards to the <a href="validator.html#sui_system_validator">validator</a>. Don&#x27;t try and distribute rewards though <b>if</b> the payout is zero.
        <b>if</b> (validator_reward.value() &gt; 0) {
            <b>let</b> validator_address = <a href="validator.html#sui_system_validator">validator</a>.sui_address();
            <b>let</b> rewards_stake = <a href="validator.html#sui_system_validator">validator</a>.<a href="validator_set.html#sui_system_validator_set_request_add_stake">request_add_stake</a>(
                validator_reward,
                validator_address,
                ctx,
            );
            transfer::public_transfer(rewards_stake, validator_address);
        } <b>else</b> {
            validator_reward.destroy_zero();
        };
        // Add rewards to stake staking pool to auto compound <b>for</b> stakers.
        <a href="validator.html#sui_system_validator">validator</a>.deposit_stake_rewards(staker_reward);
    });
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_emit_validator_epoch_events">Function <code>emit_validator_epoch_events</code><a href="validator_set.html#sui_system_validator_set_emit_validator_epoch_events" class="hash-link" aria-label="Direct link to sui_system_validator_set_emit_validator_epoch_events" title="Direct link to sui_system_validator_set_emit_validator_epoch_events">​</a></h2>
<p>Emit events containing information of each validator for the epoch,
including stakes, rewards, performance, etc.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_emit_validator_epoch_events">emit_validator_epoch_events</a>(new_epoch: u64, vs: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, pool_staking_reward_amounts: &amp;vector&lt;u64&gt;, storage_fund_staking_reward_amounts: &amp;vector&lt;u64&gt;, report_records: &amp;<a href="../sui/vec_map.html#sui_vec_map_VecMap">sui::vec_map::VecMap</a>&lt;<b>address</b>, <a href="../sui/vec_set.html#sui_vec_set_VecSet">sui::vec_set::VecSet</a>&lt;<b>address</b>&gt;&gt;, slashed_validators: &amp;vector&lt;<b>address</b>&gt;)
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>fun</b> <a href="validator_set.html#sui_system_validator_set_emit_validator_epoch_events">emit_validator_epoch_events</a>(
    new_epoch: u64,
    vs: &amp;vector&lt;Validator&gt;,
    pool_staking_reward_amounts: &amp;vector&lt;u64&gt;,
    storage_fund_staking_reward_amounts: &amp;vector&lt;u64&gt;,
    report_records: &amp;VecMap&lt;<b>address</b>, VecSet&lt;<b>address</b>&gt;&gt;,
    slashed_validators: &amp;vector&lt;<b>address</b>&gt;,
) {
    <b>let</b> length = vs.length();
    length.do!(|i| {
        <b>let</b> v = &amp;vs[i];
        <b>let</b> validator_address = v.sui_address();
        <b>let</b> tallying_rule_reporters = <b>if</b> (report_records.contains(&amp;validator_address)) {
            report_records[&amp;validator_address].into_keys()
        } <b>else</b> {
            vector[]
        };
        <b>let</b> tallying_rule_global_score = <b>if</b> (slashed_validators.contains(&amp;validator_address)) {
            0
        } <b>else</b> {
            1
        };
        event::emit(<a href="validator_set.html#sui_system_validator_set_ValidatorEpochInfoEventV2">ValidatorEpochInfoEventV2</a> {
            epoch: new_epoch,
            validator_address,
            reference_gas_survey_quote: v.gas_price(),
            stake: v.<a href="validator_set.html#sui_system_validator_set_total_stake">total_stake</a>(),
            <a href="voting_power.html#sui_system_voting_power">voting_power</a>: v.<a href="voting_power.html#sui_system_voting_power">voting_power</a>(),
            commission_rate: v.commission_rate(),
            pool_staking_reward: pool_staking_reward_amounts[i],
            storage_fund_staking_reward: storage_fund_staking_reward_amounts[i],
            pool_token_exchange_rate: v.pool_token_exchange_rate_at_epoch(new_epoch),
            tallying_rule_reporters,
            tallying_rule_global_score,
        });
    });
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_sum_voting_power_by_addresses">Function <code>sum_voting_power_by_addresses</code><a href="validator_set.html#sui_system_validator_set_sum_voting_power_by_addresses" class="hash-link" aria-label="Direct link to sui_system_validator_set_sum_voting_power_by_addresses" title="Direct link to sui_system_validator_set_sum_voting_power_by_addresses">​</a></h2>
<p>Sum up the total stake of a given list of validator addresses.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_sum_voting_power_by_addresses">sum_voting_power_by_addresses</a>(vs: &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;, addresses: &amp;vector&lt;<b>address</b>&gt;): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_sum_voting_power_by_addresses">sum_voting_power_by_addresses</a>(vs: &amp;vector&lt;Validator&gt;, addresses: &amp;vector&lt;<b>address</b>&gt;): u64 {
    <b>let</b> <b>mut</b> sum = 0;
    addresses.do_ref!(|addr| {
        <b>let</b> <a href="validator.html#sui_system_validator">validator</a> = <a href="validator_set.html#sui_system_validator_set_get_validator_ref">get_validator_ref</a>(vs, *addr);
        sum = sum + <a href="validator.html#sui_system_validator">validator</a>.<a href="voting_power.html#sui_system_voting_power">voting_power</a>();
    });
    sum
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_active_validators">Function <code>active_validators</code><a href="validator_set.html#sui_system_validator_set_active_validators" class="hash-link" aria-label="Direct link to sui_system_validator_set_active_validators" title="Direct link to sui_system_validator_set_active_validators">​</a></h2>
<p>Return the active validators in self</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>): &amp;vector&lt;<a href="validator.html#sui_system_validator_Validator">sui_system::validator::Validator</a>&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>): &amp;vector&lt;Validator&gt; {
    &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_is_validator_candidate">Function <code>is_validator_candidate</code><a href="validator_set.html#sui_system_validator_set_is_validator_candidate" class="hash-link" aria-label="Direct link to sui_system_validator_set_is_validator_candidate" title="Direct link to sui_system_validator_set_is_validator_candidate">​</a></h2>
<p>Returns true if the addr is a validator candidate.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_validator_candidate">is_validator_candidate</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, addr: <b>address</b>): bool
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_validator_candidate">is_validator_candidate</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, addr: <b>address</b>): bool {
    self.validator_candidates.contains(addr)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_is_active_validator">Function <code>is_active_validator</code><a href="validator_set.html#sui_system_validator_set_is_active_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_is_active_validator" title="Direct link to sui_system_validator_set_is_active_validator">​</a></h2>
<p>Returns true if addr is an active validator</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_active_validator">is_active_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, addr: <b>address</b>): bool
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_active_validator">is_active_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, addr: <b>address</b>): bool {
    self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>.any!(|v| v.sui_address() == addr)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_is_inactive_validator">Function <code>is_inactive_validator</code><a href="validator_set.html#sui_system_validator_set_is_inactive_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_is_inactive_validator" title="Direct link to sui_system_validator_set_is_inactive_validator">​</a></h2>
<p>Returns true if the staking pool identified by staking_pool_id is of an inactive validator.</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_inactive_validator">is_inactive_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, staking_pool_id: <a href="../sui-framework/object.html#sui_object_ID">sui::object::ID</a>): bool
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_inactive_validator">is_inactive_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, staking_pool_id: ID): bool {
    self.inactive_validators.contains(staking_pool_id)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_is_at_risk_validator">Function <code>is_at_risk_validator</code><a href="validator_set.html#sui_system_validator_set_is_at_risk_validator" class="hash-link" aria-label="Direct link to sui_system_validator_set_is_at_risk_validator" title="Direct link to sui_system_validator_set_is_at_risk_validator">​</a></h2>
<p>Return true if addr is currently an at-risk validator below the minimum stake for removal</p>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_at_risk_validator">is_at_risk_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>, addr: <b>address</b>): bool
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_is_at_risk_validator">is_at_risk_validator</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>, addr: <b>address</b>): bool {
    self.at_risk_validators.contains(&amp;addr)
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_active_validator_addresses">Function <code>active_validator_addresses</code><a href="validator_set.html#sui_system_validator_set_active_validator_addresses" class="hash-link" aria-label="Direct link to sui_system_validator_set_active_validator_addresses" title="Direct link to sui_system_validator_set_active_validator_addresses">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_active_validator_addresses">active_validator_addresses</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">sui_system::validator_set::ValidatorSet</a>): vector&lt;<b>address</b>&gt;
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>public</b>(package) <b>fun</b> <a href="validator_set.html#sui_system_validator_set_active_validator_addresses">active_validator_addresses</a>(self: &amp;<a href="validator_set.html#sui_system_validator_set_ValidatorSet">ValidatorSet</a>): vector&lt;<b>address</b>&gt; {
    <b>let</b> vs = &amp;self.<a href="validator_set.html#sui_system_validator_set_active_validators">active_validators</a>;
    <b>let</b> <b>mut</b> res = vector[];
    vs.do_ref!(|v| res.push_back(v.sui_address()));
    res
}
</code></pre>
</div></div></details></div>
<h2 class="anchor anchorWithStickyNavbar_uDrR" id="sui_system_validator_set_mul_div">Macro function <code>mul_div</code><a href="validator_set.html#sui_system_validator_set_mul_div" class="hash-link" aria-label="Direct link to sui_system_validator_set_mul_div" title="Direct link to sui_system_validator_set_mul_div">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>macro</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_mul_div">mul_div</a>($a: u64, $b: u64, $c: u64): u64
</code></pre>
<div class="relative"><span class="absolute rounded -top-3 -left-1 text-xs bg-white dark:bg-sui-gray-95 px-2 py-0.5 border border-sui-gray-65 border-solid opacity-0 duration-300 transition-opacity">Click to <!-- -->open</span><details class="details_Au2Z alert alert--info details_J1U8 bg-sui-gray-45 !border-sui-gray-65 dark:bg-sui-gray-90 dark:border-sui-gray-65" data-collapsed="true"><summary>Implementation</summary><div><div class="collapsibleContent_wc6p">
<!-- -->
<pre tabindex="0" class="codeBlockStandalone_P_D5 thin-scrollbar codeBlockContainer_VAgd theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_FRD_"><b>macro</b> <b>fun</b> <a href="validator_set.html#sui_system_validator_set_mul_div">mul_div</a>($a: u64, $b: u64, $c: u64): u64 {
    (($a <b>as</b> u128) * ($b <b>as</b> u128) / ($c <b>as</b> u128)) <b>as</b> u64
}
</code></pre>
</div></div></details></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/MystenLabs/sui/tree/main/docs/docs/../content/references/framework/sui_system/validator_set.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UIwc" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_ddNZ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="validator_cap.html"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">validator_cap</div></a><a class="pagination-nav__link pagination-nav__link--next" href="validator_wrapper.html"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">validator_wrapper</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_M9jW thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="validator_set.html#sui_system_validator_set_ValidatorSet" class="table-of-contents__link toc-highlight">Struct <code>ValidatorSet</code></a></li><li><a href="validator_set.html#sui_system_validator_set_ValidatorEpochInfoEvent" class="table-of-contents__link toc-highlight">Struct <code>ValidatorEpochInfoEvent</code></a></li><li><a href="validator_set.html#sui_system_validator_set_ValidatorEpochInfoEventV2" class="table-of-contents__link toc-highlight">Struct <code>ValidatorEpochInfoEventV2</code></a></li><li><a href="validator_set.html#sui_system_validator_set_ValidatorJoinEvent" class="table-of-contents__link toc-highlight">Struct <code>ValidatorJoinEvent</code></a></li><li><a href="validator_set.html#sui_system_validator_set_ValidatorLeaveEvent" class="table-of-contents__link toc-highlight">Struct <code>ValidatorLeaveEvent</code></a></li><li><a href="validator_set.html#sui_system_validator_set_VotingPowerAdmissionStartEpochKey" class="table-of-contents__link toc-highlight">Struct <code>VotingPowerAdmissionStartEpochKey</code></a></li><li><a href="validator_set.html#constants" class="table-of-contents__link toc-highlight">Constants</a></li><li><a href="validator_set.html#sui_system_validator_set_new" class="table-of-contents__link toc-highlight">Function <code>new</code></a></li><li><a href="validator_set.html#sui_system_validator_set_request_add_validator_candidate" class="table-of-contents__link toc-highlight">Function <code>request_add_validator_candidate</code></a></li><li><a href="validator_set.html#sui_system_validator_set_request_remove_validator_candidate" class="table-of-contents__link toc-highlight">Function <code>request_remove_validator_candidate</code></a></li><li><a href="validator_set.html#sui_system_validator_set_request_add_validator" class="table-of-contents__link toc-highlight">Function <code>request_add_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_can_join" class="table-of-contents__link toc-highlight">Function <code>can_join</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_voting_power_thresholds" class="table-of-contents__link toc-highlight">Function <code>get_voting_power_thresholds</code></a></li><li><a href="validator_set.html#sui_system_validator_set_assert_no_pending_or_active_duplicates" class="table-of-contents__link toc-highlight">Function <code>assert_no_pending_or_active_duplicates</code></a></li><li><a href="validator_set.html#sui_system_validator_set_request_remove_validator" class="table-of-contents__link toc-highlight">Function <code>request_remove_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_request_add_stake" class="table-of-contents__link toc-highlight">Function <code>request_add_stake</code></a></li><li><a href="validator_set.html#sui_system_validator_set_request_withdraw_stake" class="table-of-contents__link toc-highlight">Function <code>request_withdraw_stake</code></a></li><li><a href="validator_set.html#sui_system_validator_set_convert_to_fungible_staked_sui" class="table-of-contents__link toc-highlight">Function <code>convert_to_fungible_staked_sui</code></a></li><li><a href="validator_set.html#sui_system_validator_set_redeem_fungible_staked_sui" class="table-of-contents__link toc-highlight">Function <code>redeem_fungible_staked_sui</code></a></li><li><a href="validator_set.html#sui_system_validator_set_request_set_commission_rate" class="table-of-contents__link toc-highlight">Function <code>request_set_commission_rate</code></a></li><li><a href="validator_set.html#sui_system_validator_set_advance_epoch" class="table-of-contents__link toc-highlight">Function <code>advance_epoch</code></a></li><li><a href="validator_set.html#sui_system_validator_set_update_validator_positions_and_calculate_total_stake" class="table-of-contents__link toc-highlight">Function <code>update_validator_positions_and_calculate_total_stake</code></a></li><li><a href="validator_set.html#sui_system_validator_set_effectuate_staged_metadata" class="table-of-contents__link toc-highlight">Function <code>effectuate_staged_metadata</code></a></li><li><a href="validator_set.html#sui_system_validator_set_derive_reference_gas_price" class="table-of-contents__link toc-highlight">Function <code>derive_reference_gas_price</code></a></li><li><a href="validator_set.html#sui_system_validator_set_total_stake" class="table-of-contents__link toc-highlight">Function <code>total_stake</code></a></li><li><a href="validator_set.html#sui_system_validator_set_validator_total_stake_amount" class="table-of-contents__link toc-highlight">Function <code>validator_total_stake_amount</code></a></li><li><a href="validator_set.html#sui_system_validator_set_validator_stake_amount" class="table-of-contents__link toc-highlight">Function <code>validator_stake_amount</code></a></li><li><a href="validator_set.html#sui_system_validator_set_validator_voting_power" class="table-of-contents__link toc-highlight">Function <code>validator_voting_power</code></a></li><li><a href="validator_set.html#sui_system_validator_set_validator_staking_pool_id" class="table-of-contents__link toc-highlight">Function <code>validator_staking_pool_id</code></a></li><li><a href="validator_set.html#sui_system_validator_set_staking_pool_mappings" class="table-of-contents__link toc-highlight">Function <code>staking_pool_mappings</code></a></li><li><a href="validator_set.html#sui_system_validator_set_validator_address_by_pool_id" class="table-of-contents__link toc-highlight">Function <code>validator_address_by_pool_id</code></a></li><li><a href="validator_set.html#sui_system_validator_set_pool_exchange_rates" class="table-of-contents__link toc-highlight">Function <code>pool_exchange_rates</code></a></li><li><a href="validator_set.html#sui_system_validator_set_next_epoch_validator_count" class="table-of-contents__link toc-highlight">Function <code>next_epoch_validator_count</code></a></li><li><a href="validator_set.html#sui_system_validator_set_is_active_validator_by_sui_address" class="table-of-contents__link toc-highlight">Function <code>is_active_validator_by_sui_address</code></a></li><li><a href="validator_set.html#sui_system_validator_set_is_duplicate_with_active_validator" class="table-of-contents__link toc-highlight">Function <code>is_duplicate_with_active_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_is_duplicate_validator" class="table-of-contents__link toc-highlight">Function <code>is_duplicate_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_count_duplicates_vec" class="table-of-contents__link toc-highlight">Function <code>count_duplicates_vec</code></a></li><li><a href="validator_set.html#sui_system_validator_set_is_duplicate_with_pending_validator" class="table-of-contents__link toc-highlight">Function <code>is_duplicate_with_pending_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_count_duplicates_tablevec" class="table-of-contents__link toc-highlight">Function <code>count_duplicates_tablevec</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_candidate_or_active_validator_mut" class="table-of-contents__link toc-highlight">Function <code>get_candidate_or_active_validator_mut</code></a></li><li><a href="validator_set.html#sui_system_validator_set_find_validator" class="table-of-contents__link toc-highlight">Function <code>find_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_find_validator_from_table_vec" class="table-of-contents__link toc-highlight">Function <code>find_validator_from_table_vec</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_validator_indices" class="table-of-contents__link toc-highlight">Function <code>get_validator_indices</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_validator_mut" class="table-of-contents__link toc-highlight">Function <code>get_validator_mut</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_mut" class="table-of-contents__link toc-highlight">Function <code>get_active_or_pending_or_candidate_validator_mut</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_verified_cap" class="table-of-contents__link toc-highlight">Function <code>get_validator_mut_with_verified_cap</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx" class="table-of-contents__link toc-highlight">Function <code>get_validator_mut_with_ctx</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_validator_mut_with_ctx_including_candidates" class="table-of-contents__link toc-highlight">Function <code>get_validator_mut_with_ctx_including_candidates</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_validator_ref" class="table-of-contents__link toc-highlight">Function <code>get_validator_ref</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_active_or_pending_or_candidate_validator_ref" class="table-of-contents__link toc-highlight">Function <code>get_active_or_pending_or_candidate_validator_ref</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_active_validator_ref" class="table-of-contents__link toc-highlight">Function <code>get_active_validator_ref</code></a></li><li><a href="validator_set.html#sui_system_validator_set_get_pending_validator_ref" class="table-of-contents__link toc-highlight">Function <code>get_pending_validator_ref</code></a></li><li><a href="validator_set.html#sui_system_validator_set_verify_cap" class="table-of-contents__link toc-highlight">Function <code>verify_cap</code></a></li><li><a href="validator_set.html#sui_system_validator_set_process_pending_removals" class="table-of-contents__link toc-highlight">Function <code>process_pending_removals</code></a></li><li><a href="validator_set.html#sui_system_validator_set_process_validator_departure" class="table-of-contents__link toc-highlight">Function <code>process_validator_departure</code></a></li><li><a href="validator_set.html#sui_system_validator_set_clean_report_records_leaving_validator" class="table-of-contents__link toc-highlight">Function <code>clean_report_records_leaving_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_sort_removal_list" class="table-of-contents__link toc-highlight">Function <code>sort_removal_list</code></a></li><li><a href="validator_set.html#sui_system_validator_set_process_pending_stakes_and_withdraws" class="table-of-contents__link toc-highlight">Function <code>process_pending_stakes_and_withdraws</code></a></li><li><a href="validator_set.html#sui_system_validator_set_calculate_total_stakes" class="table-of-contents__link toc-highlight">Function <code>calculate_total_stakes</code></a></li><li><a href="validator_set.html#sui_system_validator_set_adjust_stake_and_gas_price" class="table-of-contents__link toc-highlight">Function <code>adjust_stake_and_gas_price</code></a></li><li><a href="validator_set.html#sui_system_validator_set_compute_reward_adjustments" class="table-of-contents__link toc-highlight">Function <code>compute_reward_adjustments</code></a></li><li><a href="validator_set.html#sui_system_validator_set_compute_slashed_validators" class="table-of-contents__link toc-highlight">Function <code>compute_slashed_validators</code></a></li><li><a href="validator_set.html#sui_system_validator_set_compute_unadjusted_reward_distribution" class="table-of-contents__link toc-highlight">Function <code>compute_unadjusted_reward_distribution</code></a></li><li><a href="validator_set.html#sui_system_validator_set_compute_adjusted_reward_distribution" class="table-of-contents__link toc-highlight">Function <code>compute_adjusted_reward_distribution</code></a></li><li><a href="validator_set.html#sui_system_validator_set_distribute_reward" class="table-of-contents__link toc-highlight">Function <code>distribute_reward</code></a></li><li><a href="validator_set.html#sui_system_validator_set_emit_validator_epoch_events" class="table-of-contents__link toc-highlight">Function <code>emit_validator_epoch_events</code></a></li><li><a href="validator_set.html#sui_system_validator_set_sum_voting_power_by_addresses" class="table-of-contents__link toc-highlight">Function <code>sum_voting_power_by_addresses</code></a></li><li><a href="validator_set.html#sui_system_validator_set_active_validators" class="table-of-contents__link toc-highlight">Function <code>active_validators</code></a></li><li><a href="validator_set.html#sui_system_validator_set_is_validator_candidate" class="table-of-contents__link toc-highlight">Function <code>is_validator_candidate</code></a></li><li><a href="validator_set.html#sui_system_validator_set_is_active_validator" class="table-of-contents__link toc-highlight">Function <code>is_active_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_is_inactive_validator" class="table-of-contents__link toc-highlight">Function <code>is_inactive_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_is_at_risk_validator" class="table-of-contents__link toc-highlight">Function <code>is_at_risk_validator</code></a></li><li><a href="validator_set.html#sui_system_validator_set_active_validator_addresses" class="table-of-contents__link toc-highlight">Function <code>active_validator_addresses</code></a></li><li><a href="validator_set.html#sui_system_validator_set_mul_div" class="table-of-contents__link toc-highlight">Macro function <code>mul_div</code></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer_BCnt"><div class="footerWrap_s_fg"><div class="footerLogo_uCsX"><a href="https://sui.io" rel="noopener noreferrer" class="footerLogoLink_DDai"><img src="../../../img/sui-logo-footer.svg" alt="Sui Logo" class="footer__logo themedComponent_fc7v themedComponent--light_SFoa"><img src="../../../img/sui-logo-footer.svg" alt="Sui Logo" class="footer__logo themedComponent_fc7v themedComponent--dark_o7dU"></a></div><div class="footerContent_UF16"><div class="footerLinks_O35S"><a href="https://discord.gg/Sui" target="_blank" rel="noopener noreferrer"><svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32ZM18.519 8.80985C19.7766 9.02894 20.9792 9.41425 22.1012 9.93555C22.111 9.93957 22.1191 9.94707 22.1239 9.9567C24.1119 12.9198 25.0931 16.2637 24.7265 20.1122C24.7256 20.1203 24.7231 20.1282 24.719 20.1352C24.715 20.1423 24.7095 20.1483 24.703 20.153C23.3695 21.1539 21.8815 21.9153 20.3017 22.4052C20.2905 22.4086 20.2786 22.4084 20.2676 22.4046C20.2566 22.4008 20.247 22.3936 20.2401 22.384C19.9079 21.9149 19.6057 21.4207 19.3418 20.9017C19.3382 20.8946 19.3361 20.8867 19.3357 20.8786C19.3352 20.8706 19.3365 20.8626 19.3394 20.855C19.3422 20.8475 19.3466 20.8407 19.3522 20.8351C19.3578 20.8295 19.3645 20.8251 19.3718 20.8224C19.8507 20.6396 20.3068 20.4197 20.7453 20.1598C20.7531 20.155 20.7597 20.1483 20.7644 20.1403C20.769 20.1323 20.7717 20.1232 20.7722 20.1138C20.7726 20.1045 20.7708 20.0951 20.7669 20.0867C20.7629 20.0782 20.757 20.0709 20.7497 20.0654C20.6566 19.9951 20.5649 19.9218 20.4769 19.8478C20.4689 19.8412 20.4591 19.837 20.4489 19.8358C20.4387 19.8346 20.4283 19.8364 20.419 19.841C17.573 21.1737 14.4542 21.1737 11.5745 19.841C11.5652 19.8367 11.555 19.8351 11.5449 19.8364C11.5348 19.8378 11.5252 19.842 11.5173 19.8485C11.4293 19.9218 11.3369 19.9951 11.2445 20.0654C11.2373 20.071 11.2315 20.0784 11.2277 20.087C11.2239 20.0955 11.2222 20.1049 11.2228 20.1142C11.2233 20.1236 11.2262 20.1326 11.231 20.1406C11.2358 20.1486 11.2425 20.1552 11.2504 20.1598C11.6904 20.4176 12.1494 20.6394 12.6231 20.8231C12.6305 20.8258 12.6372 20.8301 12.6428 20.8356C12.6484 20.8412 12.6527 20.8479 12.6556 20.8554C12.6584 20.8628 12.6597 20.8708 12.6593 20.8788C12.6589 20.8868 12.6568 20.8946 12.6532 20.9017C12.3943 21.4211 12.0935 21.9172 11.7542 22.3848C11.747 22.3941 11.7373 22.4009 11.7263 22.4044C11.7153 22.4079 11.7036 22.4079 11.6926 22.4044C10.1155 21.9132 8.62981 21.1521 7.29783 20.153C7.2915 20.148 7.28623 20.1418 7.28232 20.1346C7.27841 20.1275 7.27595 20.1196 7.2751 20.1115C6.96784 16.7827 7.59336 13.4116 9.87542 9.95519C9.88104 9.94609 9.88923 9.93897 9.89889 9.93479C11.0216 9.41274 12.2242 9.02743 13.4811 8.80834C13.4925 8.80648 13.5041 8.80824 13.5144 8.81337C13.5248 8.8185 13.5334 8.82676 13.5391 8.83704C13.7065 9.13791 13.8576 9.44814 13.9915 9.76632C15.3253 9.561 16.6814 9.561 18.0152 9.76632C18.1355 9.47922 18.307 9.11583 18.461 8.83704C18.4668 8.82688 18.4754 8.8188 18.4858 8.81393C18.4962 8.80906 18.5078 8.80763 18.519 8.80985ZM11.5019 16.2863C11.5019 17.2768 12.2169 18.0844 13.0837 18.0844C13.9644 18.0844 14.6654 17.2776 14.6654 16.2863C14.6794 15.3019 13.971 14.4882 13.0837 14.4882C12.203 14.4882 11.5019 15.2951 11.5019 16.2863ZM17.3501 16.2863C17.3501 17.2768 18.0643 18.0844 18.9318 18.0844C19.8199 18.0844 20.5136 17.2776 20.5136 16.2863C20.5275 15.3019 19.8191 14.4882 18.9318 14.4882C18.0504 14.4882 17.3501 15.2951 17.3501 16.2863Z" fill="#F7F7F8"></path></svg></a><a href="https://x.com/suinetwork" target="_blank" rel="noopener noreferrer"><svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32ZM23.4785 8L17.5222 15.1983H17.5218L24 25H19.2356L14.8732 18.3996L9.41155 25H8L14.2466 17.4514L8 8H12.7644L16.8952 14.2502L22.0671 8H23.4785ZM14.956 16.5936L15.5889 17.5347V17.5351L19.8997 23.9455H22.0677L16.7851 16.0896L16.1522 15.1484L12.0882 9.10473H9.92015L14.956 16.5936Z" fill="#F7F7F8"></path></svg></a><a href="https://www.youtube.com/@Sui-Network" target="_blank" rel="noopener noreferrer"><svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16345 24.8366 0 16 0C7.16345 0 0 7.16345 0 16C0 24.8366 7.16345 32 16 32ZM12.4216 22.5897L16.2654 22.6599C16.2715 22.6599 16.2838 22.6599 16.2837 22.6693C18.4242 22.7093 20.5097 22.5839 22.6442 22.4281C24.3478 22.309 24.7515 21.0753 24.9625 19.6041C25.2255 17.8272 25.2836 16.029 25.146 14.2399C25.1394 14.1551 25.133 14.0695 25.1265 13.9834C24.9983 12.2716 24.8541 10.3478 22.8277 9.99315C22.3965 9.91678 21.9562 9.84968 21.519 9.83741C17.3786 9.7035 13.2014 9.66949 9.05176 9.95651C7.82251 10.0356 7.02764 10.7624 6.82566 11.9804C6.46788 14.1511 6.39448 16.3798 6.58407 18.5688C6.58644 18.5956 6.5888 18.6224 6.59117 18.6494C6.7267 20.1892 6.88506 21.9886 8.70927 22.3607C9.69137 22.5646 10.6913 22.5728 11.6931 22.5809C11.9359 22.5829 12.1788 22.5849 12.4216 22.5897ZM16.0006 17.7909C15.3384 18.1708 14.6747 18.5517 14.0056 18.9352V13.4459C14.7432 13.8683 15.4755 14.2887 16.2087 14.7096C17.0653 15.2013 17.923 15.6937 18.7913 16.1905C17.8572 16.7255 16.9304 17.2573 16.0006 17.7909Z" fill="#F7F7F8"></path></svg></a><a href="https://www.linkedin.com/company/sui-foundation/" target="_blank" rel="noopener noreferrer"><svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 0C7.16337 0 0 7.16339 0 16C0 24.8366 7.16337 32 16 32C24.8366 32 32 24.8366 32 16C31.9999 7.16339 24.8364 0 16 0ZM11.7311 23.7353H8.21819V12.3859H11.7311V23.7353ZM9.95793 10.8996C8.81063 10.8996 7.88055 9.96193 7.88055 8.80545C7.88055 7.64883 8.81076 6.71123 9.95793 6.71123C11.1051 6.71123 12.0352 7.64883 12.0352 8.80545C12.0352 9.962 11.1052 10.8996 9.95793 10.8996ZM24.8959 23.7353H21.4V17.7778C21.4 16.1438 20.7794 15.2317 19.4873 15.2317C18.0812 15.2317 17.3466 16.1817 17.3466 17.7778V23.7353H13.9773V12.3859H17.3466V13.9145C17.3466 13.9145 18.3601 12.0397 20.7666 12.0397C23.1732 12.0397 24.896 13.5091 24.896 16.549L24.8959 23.7353Z" fill="#F7F7F8"></path></svg></a></div><div class="footerCopy_WbJ_"><div class="text-sm lg:text-xs xl:text-sm mt-2">© 2025 Sui Foundation | Documentation distributed under <a href="https://github.com/MystenLabs/sui/blob/main/docs/site/LICENSE">CC BY 4.0</a></div></div></div></div></footer></div>
<div id="__cookbook" data-api-key="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2NjU5ODBiNDAwZTliZDQ2MzcwZDlhNzYiLCJpYXQiOjE3MTcxNDE2ODQsImV4cCI6MjAzMjcxNzY4NH0.0JCgi4bJ_f6ILFgEyYAP-KeCm1dzOKwH30tC3jEs2_A"></div>

            <script>function initCookbook(){try{window.__cookbook_script&&window.__cookbook_script.remove();const o=document.createElement("script");o.src="https://cdn.jsdelivr.net/npm/@cookbookdev/docsbot/dist/standalone/index.cjs.js",o.async=!0,document.body.appendChild(o),window.__cookbook_script=o}catch(o){console.error("Error while initializing Cookbook:",o)}}</script></body>
</html>